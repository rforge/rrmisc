---
date:     "`r format(Sys.time(), '%d.%B %Y')`"
output:
  pdf_document:
    number_sections: true
    toc: true
    toc_depth: 3
    latex_engine: pdflatex
    keep_tex: false
    template: default.latex
    fig_caption: true
  html_document:
    self_contained: false
    number_sections: true
    toc: true
    toc_depth: 3
    toc_float: true
    theme: yeti
    keep_md: true
  word_document:
    toc: true
    toc_depth: 3
params:
  Title: NA
  Author: NA
  fn_Data1: NA
  fn_Data2: NA
  OutputFormat: NA
  DataPath: NA
  fn_ProfileData1: NA
  fn_ProfileData2: NA
  BeschreibungDaten1: NA
  BeschreibungDaten2: NA
  MaxN: NA
  WidthNames: NA
  PrettyN: NA
editor_options:
  chunk_output_type: console
link-citations: true
documentclass: scrartcl
classoption: a4paper, table
fontsize: 11pt
lang: de-CH
geometry:
- tmargin=2cm
- bmargin=2cm
- lmargin=2cm
- rmargin=1.5cm
header-includes:
- \usepackage[utf8]{inputenc}
- \usepackage{graphicx}
- \usepackage{xcolor}
- \usepackage{float}
- \usepackage{longtable}
- \usepackage{booktabs}
- \usepackage{titling}
- \pretitle{\begin{flushleft}\LARGE}
- \posttitle{\par\end{flushleft}}
- \preauthor{\begin{flushleft}\large}
- \postauthor{\par\end{flushleft}}
- \predate{\begin{flushleft}\large}
- \postdate{\par\end{flushleft}}
- \usepackage{pdflscape}
- \usepackage{makecell}
---

```{r setup, echo=FALSE, eval=TRUE, include=FALSE}
# --------------------------------------------------------------------------------------------------
# R - Chunk Options ................................................................................#{{{
# <<label=definitions,      'label for this R-chunk'
#   eval=TRUE,              FALSE
#   echo=TRUE,              FALSE
#   results=verbatim,       tex, hide
#   prefix=TRUE,            FALSE   generated filenames and figures have common prefix
#   prefix.string,          defaults to Sweave-Option
#   include=TRUE,           --- ?
#   fig=FALSE,              TRUE    includes figure
#   eps=TRUE,               FALSE   create EPS figures
#   pdf=TRUE,               FALSE   create PDF figures
#   width=6                 width of figures in inch
#   height=6                height of figures in inch
#}}}
# Rmarkdown Reference ..............................................................................{{{
#
# browseURL("https://bookdown.org/yihui/rmarkdown-cookbook/")
#
#}}}
# --------------------------------------------------------------------------------------------------
cat("-- 0 --\n")
# *Not run*  INPUT -- MANUELL ----------------------------------------------------------------------{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (FALSE) {
  # Produktiver YAML Header für Parameterliste
params:
  Title: NA
  Author: NA
  fn_Data1: NA
  fn_Data2: NA
  OutputFormat: NA
  DataPath: NA
  fn_ProfileData1: NA
  fn_ProfileData2: NA
  BeschreibungDaten1: NA
  BeschreibungDaten2: NA
  MaxN: NA
  WidthNames: NA
  PrettyN: NA
  # YAML Header für manuelle Übergabe der Parameter
params:
  Title: "Titel Bericht"
  Author: "R.R."
  fn_Data1: "Test-File1.RData"
  fn_Data2: "Test-File2.RData"
  OutputFormat: "pdf"
  OutputFormat: "html"
  OutputFormat: "word"
  # DataPath: "G:/Vt/Tm/Allg/RRapold/01_R_Auswertungen"
  DataPath: "G:/Vt/Tm/Allg/RRapold/03_R_Shiny/AppProfile"
  fn_ProfileData1: "Data1_Profile.RData"
  fn_ProfileData2: NA
  fn_ProfileData2: "Data2_Profile.RData"
  BeschreibungDaten1: "ABT kunde 1"
  BeschreibungDaten2: "ABT kunde 2"
  BeschreibungDaten2: NA
  MaxN: 42
  WidthNames: 35
  PrettyN: 5
  # Manuelle Definition der Parameter ohne YAML Header
  params <- list(Title = "Titel Bericht",
                 Author = "R.R.",
                 fn_Data1 = "Test-File1.RData",
                 fn_Data2 = "Test-File2.RData",
                 OutputFormat = "pdf",
                 # DataPath = "G:/Vt/Tm/Allg/RRapold/01_R_Auswertungen",
                 DataPath = "G:/Vt/Tm/Allg/RRapold/03_R_Shiny/AppProfile",
                 fn_ProfileData1 = "Data1_Profile.RData",
                 fn_ProfileData2 = "Data2_Profile.RData",
                 # fn_ProfileData2 = NA,
                 BeschreibungDaten1 = "ABT kunde 1",
                 BeschreibungDaten2 = "ABT kunde 2",
                 # BeschreibungDaten2 = NA,
                 MaxN = 42,
                 WidthNames = 35,
                 PrettyN = 5)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#> }}}
# Definition von Output-Format aus 'params' übernehmen .............................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
Title              <- params$Title
Author             <- params$Author
fn_Data1           <- params$fn_Data1
fn_Data2           <- params$fn_Data2
DataPath           <- params$DataPath
fn_ProfileData1    <- params$fn_ProfileData1
fn_ProfileData2    <- params$fn_ProfileData2
BeschreibungDaten1 <- params$BeschreibungDaten1
BeschreibungDaten2 <- params$BeschreibungDaten2
OutputFormat       <- params$OutputFormat
MaxN               <- params$MaxN          # maximale Anzahl Records pro Grafik
WidthNames         <- params$WidthNames    # minimale Anzahl Zeichen für Attribute, kürzere Namen werden links
                                           # aufgefüllt
PrettyN            <- params$PrettyN       # Anzahl Tic-Marks auf X-Achse -- Input für pretty()
# shiftTitle   <- 2.7     # Abstand für kleine Überschrift mit Lauf-Bezeichnungen
#
if (is.na(Author) | Author == "") {
  Author <- NULL
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
# }}}
# Kontrolle Input-Daten vorhanden ..................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
pfn_ProfileData1 <- file.path(DataPath, fn_ProfileData1)
if (!file.exists(pfn_ProfileData1)) {
  stop(paste("keine Datei 1 gefunden als:", pfn_ProfileData1))
}
pfn_ProfileData2 <- file.path(DataPath, fn_ProfileData2)
if (is.na(fn_ProfileData2) | fn_ProfileData2 == "NA") {
  i_ProfileData2 <- FALSE
} else {
  i_ProfileData2 <- TRUE
  if (!file.exists(pfn_ProfileData2)) {
    stop(paste("keine Datei 2 gefunden als:", pfn_ProfileData2))
  }
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
# }}}
# INPUT -- MANUELL ---------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------
#
# --------------------------------------------------------------------------------------------------
# VORBEREITUNGEN -----------------------------------------------------------------------------------
cat("-- A --\n")
# Globale Optionen für knitr                                                                      ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
options(scipen = 999)
#
if (OutputFormat == "pdf") {
  options(tinytex.verbose = TRUE)
  options(tinytex.clean = TRUE)
  options(kableExtra.latex.load_packages = FALSE)
  options(kableExtra.auto_format = FALSE)
}

options(knitr.table.format = switch(OutputFormat,
                                    "word" = "pipe",
                                    "html" = "html",
                                    "pdf"  = "latex"))
knitr::opts_chunk$set(fig.width=9, fig.height=6, # fig.path='Floats/',
                      eval=TRUE, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE,
                      fig.pos='H')
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
cat("-- B --\n")
# Pakete laden                                                                                    ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
library(rmarkdown)
library(knitr)
library(kableExtra)
library(data.table)
library(lattice)
library(latticeExtra)

#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
# }}}
cat("-- C --\n")
# Hilfsfunktionen                                                                                 ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
namesInVector <- function(KeyList, NamesList) {
  FoundKeys <- c()
  Att <- KeyList[1]
  for (Att in KeyList)
  {
    NamesIndex <- grepl(paste0("^", Att), NamesList)
    if (sum(NamesIndex) > 0) {
      FoundKeys <- c(FoundKeys, NamesList[NamesIndex])
    }
  }
  return(FoundKeys)
}

getTicDist <- function(width) {
  xsep  <- ifelse(width < 0.15, 0.02, 0.05)
  xsep  <- ifelse(width > 0.25, 0.05, xsep)
  xsep  <- ifelse(width > 0.70, 0.25, xsep)
  xsep  <- ifelse(width > 1.80, 0.50, xsep)
  xsep  <- ifelse(width > 3.00, 1.00, xsep)
  xsep  <- ifelse(width > 20.0, 5.00, xsep)
  xsep  <- ifelse(width > 40.0, 10.0, xsep)
  xsep  <- ifelse(width >  100, 25.0, xsep)
  xsep  <- ifelse(width >  200, 50.0, xsep)
  xsep  <- ifelse(width >  400,  100, xsep)
  return(xsep)
}
#
myRound <- function(x) {

  if (all(is.na(x))) {
    return(NA)
  }

  x    <- as.numeric(x)
  xRes <- x

  for (i in 1:length(x))
  {
    if (x[i] > 0) {
      if (x[i] > 100) {
        xRes[i] <- format(round(x[i], 0), big.mark = "'")
      } else if(x[i] > 1) {
        xRes[i] <- round(x[i], 2)
      } else if(x[i] > 0.1) {
        xRes[i] <- round(x[i], 3)
      } else {
        xRes[i] <- signif(x[i], 3)
      }
    } else {
      if (x[i] < -100) {
        xRes[i] <- format(round(x[i], 0), big.mark = "'")
      } else if(x[i] < -1) {
        xRes[i] <- round(x[i], 2)
      } else if(x[i] < -0.1) {
        xRes[i] <- round(x[i], 3)
      }
    }
  }
  return(xRes)
}
# tt <- c(0.003434333837, 0.144556, pi, 10.987463562352, 120.0191, 23134)
# myRound(tt)
#
substituteNA <- function(df, substChar = "-") {
  # df <- TableChar
  if (is.data.table(df)) {
    # c <- 4
    for (c in 2:ncol(df)) {
      if (class(df[[c]]) == "logical") {
        class(df[[c]]) <- "character"
      }
      df[which(is.na(df[[c]])),          (c) := substChar]
      df[which(trimws(df[[c]]) == "NA"), (c) := substChar]
    }
  }
  return(df)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
cat("-- D --\n")
# Daten laden                                                                                     ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Datei 1 --
load(pfn_ProfileData1)
if ("Profile_List" %in% ls()) {
  Data1_Profile <- Profile_List
  rm(Profile_List)
}
Profile_1a <- Data1_Profile[[1]] # Profile
Profile_1b <- Data1_Profile[[2]] # ProfileChar
Profile_1c <- Data1_Profile[[3]] # ProfileNum
Profile_1d <- Data1_Profile[[4]] # ProfileFactor
Profile_1e <- Data1_Profile[[5]] # ProfileDate
Profile_1f <- Data1_Profile[[6]] # ProfileInt
Profile_1g <- Data1_Profile[[7]] # ProfileCharLikeNum
# Profile_1h <- Data1_Profile[[8]] # ProfilePersStat
Profile_1a$name <- gsub("_", "\\\\_", Profile_1a$name) # Probleme mit Attributnamen die '_' beinhalten
Profile_1b$name <- gsub("_", "\\\\_", Profile_1b$name)
Profile_1c$name <- gsub("_", "\\\\_", Profile_1c$name)
Profile_1d$name <- gsub("_", "\\\\_", Profile_1d$name)
Profile_1e$name <- gsub("_", "\\\\_", Profile_1e$name)
Profile_1f$name <- gsub("_", "\\\\_", Profile_1f$name)
Profile_1g$name <- gsub("_", "\\\\_", Profile_1g$name)
rm(Data1_Profile)
#
# Datei 2 -- optional
if (i_ProfileData2) {
  load(pfn_ProfileData2)
  if ("Profile_List" %in% ls()) {
    Data2_Profile <- Profile_List
    rm(Profile_List)
  }
  Profile_2a <- Data2_Profile[[1]] # Profile
  Profile_2b <- Data2_Profile[[2]] # ProfileChar
  Profile_2c <- Data2_Profile[[3]] # ProfileNum
  Profile_2d <- Data2_Profile[[4]] # ProfileFactor
  Profile_2e <- Data2_Profile[[5]] # ProfileDate
  Profile_2f <- Data2_Profile[[6]] # ProfileInt
  Profile_2g <- Data2_Profile[[7]] # ProfileCharLikeNum
  # Profile_2h <- Data2_Profile[[8]] # ProfilePersStat
  Profile_2a$name <- gsub("_", "\\\\_", Profile_2a$name) # Probleme mit Attributnamen die '_' beinhalten
  Profile_2b$name <- gsub("_", "\\\\_", Profile_2b$name)
  Profile_2c$name <- gsub("_", "\\\\_", Profile_2c$name)
  Profile_2d$name <- gsub("_", "\\\\_", Profile_2d$name)
  Profile_2e$name <- gsub("_", "\\\\_", Profile_2e$name)
  Profile_2f$name <- gsub("_", "\\\\_", Profile_2f$name)
  Profile_2g$name <- gsub("_", "\\\\_", Profile_2g$name)
  rm(Data2_Profile)
}
#
# Name des Datenobjektes
# DataName1 <- as.character(Profile_1a[1, 3])
# if (i_ProfileData2) {
#   DataName2 <- as.character(Profile_2a[1, 3])
# }
#
# Attributnamen die nur in einem Datensatz vorkommen
Attr1 <- c(Profile_1a$name, Profile_1b$name, Profile_1c$name, Profile_1d$name,
           Profile_1e$name, Profile_1f$name, Profile_1g$name)
if (i_ProfileData2) {
  Attr2 <- c(Profile_2a$name, Profile_2b$name, Profile_2c$name, Profile_2d$name,
             Profile_2e$name, Profile_2f$name, Profile_2g$name)
  Attr1_not_2 <- unique(Attr1[!Attr1 %in% Attr2])
  Attr2_not_1 <- unique(Attr2[!Attr2 %in% Attr1])

  Class1_not_2 <- as.character(Attr1_not_2 %in% Profile_1b)
  Class1_not_2[Attr1_not_2 %in% Profile_1b$name] <- "Text"
  Class1_not_2[Attr1_not_2 %in% Profile_1c$name] <- "Numerisch"
  Class1_not_2[Attr1_not_2 %in% Profile_1d$name] <- "Faktor"
  Class1_not_2[Attr1_not_2 %in% Profile_1e$name] <- "Datum"
  Class1_not_2[Attr1_not_2 %in% Profile_1f$name] <- "Integer"
  Class1_not_2[Attr1_not_2 %in% Profile_1g$name] <- "Text mit numerischem Inhalt"
  # Class1_not_2

  Class2_not_1 <- as.character(Attr2_not_1 %in% Profile_2b)
  Class2_not_1[Attr2_not_1 %in% Profile_2b$name] <- "Text"
  Class2_not_1[Attr2_not_1 %in% Profile_2c$name] <- "Numerisch"
  Class2_not_1[Attr2_not_1 %in% Profile_2d$name] <- "Faktor"
  Class2_not_1[Attr2_not_1 %in% Profile_2e$name] <- "Datum"
  Class2_not_1[Attr2_not_1 %in% Profile_2f$name] <- "Integer"
  Class2_not_1[Attr2_not_1 %in% Profile_2g$name] <- "Text mit numerischem Inhalt"
  # Class2_not_1
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
cat("-- E --\n")
# Einteilung Attribute                                                                            ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# AttrKeyC        # Schlüssel-Attribute der numerischen Daten 'C'
# AttrPersC       # Personen -Attribute der numerischen Daten 'C'
# AttrDeckC       # Deckungs -Attribute der numerischen Daten 'C'
# AttrLeistC      # Leistungs-Attribute der numerischen Daten 'C'
# AttrModelC      # Modell   -Attribute der numerischen Daten 'C'
#
#
# Schlüssel - Attribute                                                                           ..
AttrKey <- c("partner.nr",                              # B003_PARTNERNR
             "B003_BOID_PAR", "B003_BOID", "B034_BOID", "B045_BOID")
#
# Personen - Attribute                                                                            ..
AttrPers <- c("familien.nr",                            # B003_FAMILIENNR
              "geburts.datum",
              "alter",
              "geschlecht",
              "sprache",
              "titel",
              "akademiker",
              "berufsbezeichnung",
              "selbststaendig",
              "berufsgruppe",
              "zivilstand",
              "familienstellung",
              "nationalitaet",
              "aufenthaltsbewilligung",
              "auslaenderstatus",
              "wohn.kanton",
              "wohn.ort",
              "wohn.plz",
              "wohn.strasse",
              "mutterschaft",
              "leistungssperren",
              "cm.unterstuetzung",
              "sozialamt",
              "mahnungen",
              "best.kollektiv",
              "SWICA.kollektiv",
              "laufende.Tagegeldfaelle",
              "aktuelle.unfaelle",
              "ausnahmen",
              "anzeigepflicht.verletzt",
              "iv.rente",
              "kostenart.601.602",
              "ablehnung.vvg",
              "psychatrische.Diagnose",
              "kontaktsperre.markt",
              "geburtsgebrechen",
              "VIP.kunde",
              "anz.Empfehlungen")
#
# Deckungs - Attribute                                                                            ..
AttrDeck <- c("rd",
              "produkt.bezeichnung.lang",
              "franchiseklasse.name",
              "kollektiv.vertrag.branche",
              "geschaeftsstelle.nr",
              "geschaeftsstelle.name",
              "B034_VERTRAGSNR",
              "vertrag.antrags.datum",
              "vertrag.start.datum",
              "vertrag.end.datum",
              "kassen.eintritt.datum",
              "zeichnung.offerte.datum",
              "produkt.start.datum",
              "produkt.end.datum",
              "austrittsgrund",
              "austrittskasse",
              "vorversicherer",
              "nachversicherer",
              "produkt.kategorie.kurz",
              "produkt.kategorie.lang",
              "produkt.bezeichnung.kurz",
              "produkt.bezeichnung.intern",
              "praemien.region.code",
              "franchise.tageswert",
              "franchise.maximalwert",
              "franchise.allgemein",
              "praemien.region.bezeichnung",
              "franchiseklasse.bezeichnung",
              "franchise.jahr.erwachsener",
              "franchise.jahr.kind",
              "rahmenvertrag.nr",
              "rahmenvertrag.bezeichnung",
              "kollektiv.vertrag.nr",
              "kollektiv.vertrag.name",
              "abgel.Versicherungserh\u00f6hungen",
              "branche.kollektiv",
              "produkt.mapping",
              "produktart",
              "alterstarif",
              "produktanzahl.besitz.20",
              "produktanzahl.gesamt.20",
              "gv.besitz.20",
              "gv.gesamt.20",
              "eb.besitz.20",
              "eb.gesamt.20",
              "ev.besitz.20",
              "ev.gesamt.20",
              "sv.besitz.20",
              "sv.gesamt.20",
              "rv.besitz.20",
              "rv.gesamt.20",
              "tv.besitz.20",
              "tv.gesamt.20",
              "zv.besitz.20",
              "zv.gesamt.20",
              "anz.familien.mitglieder",
              "vertragsdauer.lf.20",
              "max.vertragsdauer.lf.20",
              "max.vertragsdauer",
              "vorversicherer.filled",
              "praemien.region.filled",
              "kollektiv.vertrag.I",
              "rahmen.vertrag.I",
              "Anzahl.Kontakte.Mitarbeiter",
              "bestandskunde.20",
              "neukunde.20",
              "besitz.20",
              "vertrags.dauer.20",
              "bestand.20",
              "vertragsdauer",
              "kassen.eintritt.filled",
              "kasseneintitt.abschlussalter",
              "max.produkt.end")
#
# Leistungs - Attribute                                                                           ..
AttrLeist <- c("anz.belege.20",
               "anz.konsultationen.20",
               "anz.spitaltage.20",
               "leistungen.20",
               "praemien.20",
               "provision.20",
               "risikoausgleich.20",
               "Datum.Selektion.in.DENTA.Aktion.I",
               "Datum.Erreicht.in.DENTA.Aktion.I",
               "Datum.Selektion.in.19.26.Jaehrige.I",
               "Datum.Erreicht.in.19.26.Jaehrige.I",
               "Datum.Selektion.in.Upselling.HOSPITA.I",
               "Datum.Erreicht.in.Upselling.HOSPITA.I",
               "Datum.Selektion.in.Nachfassung.Kuendigung.I",
               "Datum.Erreicht.in.Nachfassung.Kuendigung.I")

# Modell-Attribute, Stand - Modelle Original Capgemini                                            ..
AttrModel <- c("zivilstand", "familienstellung", "leistungssperren",
               "mahnungen", "aktuelle.unfaelle", "vorversicherer.filled",
               "rahmen.vertrag.I", "branche.kollektiv", "rd",
               "aufenthaltsbewilligung", "wohn.kanton", "sprache",
               "geschlecht", "COMPLETA_PRAEVENTA", "COMPLETA_TOP",
               "DENTA", "HOSPITA_ALLGEMEIN", "HOSPITA_HALBPRIVAT",
               "HOSPITA_PRIVAT", "HOSPITA_PRIVAT_WELTWEIT", "INFORTUNA_HEILUNGSKOSTEN",
               "Krankenpflegeversicherung_KVG", "OPTIMA", "OTHER",
               "Rechtsschutzversicherung", "SUPPLEMENTA")
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
cat("-- F --\n")
# Numerische Attribute einteilen und Jahres-Attribute auf alle Jahre angepassen                   ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# AttrKey
# AttrPers
# AttrDeck
# AttrLeist
# AttrModel
#
AttrKey1c <- namesInVector(AttrKey, Profile_1c$name)
AttrKeyC  <- unique(c(AttrKey1c))
if (i_ProfileData2) {
  AttrKey2c <- namesInVector(AttrKey, Profile_2c$name)
  AttrKeyC  <- unique(c(AttrKey1c, AttrKey2c))
}

# Schlüsselattribute nicht berücksichtigen
# Profile_1c <- Profile_1c[!Profile_1c$name %in% AttrKeyC, ]
# Profile_2c <- Profile_2c[!Profile_2c$name %in% AttrKeyC, ]

# Nur gemeinsame Attribute berücksichtigen
# AttrC      <- intersect(Profile_1c$name, Profile_2c$name)
# Profile_1c <- Profile_1c[Profile_1c$name %in% AttrC]
# Profile_2c <- Profile_2c[Profile_2c$name %in% AttrC]

AttrPers1c <- namesInVector(AttrPers, Profile_1c$name)
AttrPersC  <- unique(c(AttrPers1c))
if (i_ProfileData2) {
  AttrPers2c <- namesInVector(AttrPers, Profile_2c$name)
  AttrPersC  <- unique(c(AttrPers1c, AttrPers2c))
}

AttrDeck1c <- namesInVector(AttrDeck, Profile_1c$name)
AttrDeckC  <- unique(c(AttrDeck1c))
if (i_ProfileData2) {
  AttrDeck2c <- namesInVector(AttrDeck, Profile_2c$name)
  AttrDeckC  <- unique(c(AttrDeck1c, AttrDeck2c))
}

AttrLeist1c <- namesInVector(AttrLeist, Profile_1c$name)
AttrLeistC  <- unique(c(AttrLeist1c))
if (i_ProfileData2) {
  AttrLeist2c <- namesInVector(AttrLeist, Profile_2c$name)
  AttrLeistC  <- unique(c(AttrLeist1c, AttrLeist2c))
}

AttrModel1c <- namesInVector(AttrModel, Profile_1c$name)
AttrModelC  <- unique(c(AttrModel1c))
if (i_ProfileData2) {
  AttrModel2c <- namesInVector(AttrModel, Profile_2c$name)
  AttrModelC  <- unique(c(AttrModel1c, AttrModel2c))
}
#
AttrRest1c <- Profile_1c$name[!Profile_1c$name %in% AttrKeyC]
AttrRest1c <- AttrRest1c[!AttrRest1c %in% AttrPersC]
AttrRest1c <- AttrRest1c[!AttrRest1c %in% AttrDeckC]
AttrRest1c <- AttrRest1c[!AttrRest1c %in% AttrLeistC]
AttrRest1c <- AttrRest1c[!AttrRest1c %in% AttrModelC]
AttrRestC  <- unique(AttrRest1c)
if (i_ProfileData2) {
  AttrRest2c <- Profile_2c$name[!Profile_2c$name %in% AttrKeyC]
  AttrRest2c <- AttrRest2c[!AttrRest2c %in% AttrPersC]
  AttrRest2c <- AttrRest2c[!AttrRest2c %in% AttrDeckC]
  AttrRest2c <- AttrRest2c[!AttrRest2c %in% AttrLeistC]
  AttrRest2c <- AttrRest2c[!AttrRest2c %in% AttrModelC]
  AttrRestC  <- unique(AttrRest1c, AttrRest2c)
}
#
# AttrKeyC
# AttrPersC
# AttrDeckC
# AttrLeistC
# AttrModelC
# AttrRestC
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
cat("-- G --\n")
#
# Grafik-Definition ................................................................................
if (i_ProfileData2) {
# lattice - theme                                                                                 ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
my.settings=latticeExtra::theEconomist.theme()
my.settings$clip$panel         <- "off"
my.settings$plot.symbol$col    <- SwicaCols[1]
my.settings$plot.symbol$cex    <- 1.2
my.settings$reference.line$lty <- 2
# show.settings(my.settings)
# lattice.options()$layout.widths$ylab
# $x
# [1] 0
# $units
# [1] "grobwidth"
# $data
# text[GRID.text.8]
# lattice.options()$layout.widths$ylab.axis.padding
# $x
# [1] 0.5
# $units
# [1] "char"
# lattice.options()$layout.widths$axis.panel
# $x
# [1] 0
# $units
# [1] "mm"
# $data
# NULL
# str(trellis.par.get("layout.widths"))
# List of 15
#  $ left.padding     : num 1
#  $ key.left         : num 1
#  $ key.ylab.padding : num 0
#  $ ylab             : num 1
#  $ ylab.axis.padding: num 1
#  $ axis.left        : num 1
#  $ axis.panel       : num 1
#  $ strip.left       : num 1
#  $ panel            : num 1
#  $ between          : num 1
#  $ axis.right       : num 1
#  $ axis.key.padding : num 1
#  $ ylab.right       : num 1
#  $ key.right        : num 1
#  $ right.padding    : num 1
# my.settings$layout.widths$left.padding                   <- 30
# my.settings$layout.widths$key.left                       <- 30
# my.settings$layout.widths$key.ylab.padding               <- 30
# my.settings$layout.widths$ylab                           <- 30
# my.settings$layout.widths$ylab.axis.padding              <- 30
# my.settings$layout.widths$axis.left                      <- 30
# my.settings$layout.widths$axis.panel                     <- 30
# my.settings$layout.widths$strip.left                     <- 30
# my.settings$layout.widths$panel                          <- 30
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#> }}}
# Funktion 'getGraphParam()'  -  Modell für Grafikparameter                                       ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
getGraphParam <- function(AnzZeilen) {
  # Grafik-Parameter
  # 13 Zeilen     height = 5   shiftTitle = 1.5
  # 20 Zeilen     height = 7   shiftTitle = 2.0    right.padding = 24
  # 31 Zeilen     height = 9   shiftTitle = 3.0    right.padding = 12
  MetaPar <- data.frame(zeilen = c(13, 20, 31),
                        height = c(5.0, 6.5, 9.5),
                        shiftTitle = c(1.7, 2.1, 2.9))
  MetaRegHeight <- lm(height~zeilen, data = MetaPar)
  MetaRegShiftT <- lm(shiftTitle~zeilen, data = MetaPar)
  # plot(MetaRegHeight)
  # plot(MetaRegShiftT)
  # xyplot(height~zeilen, data = MetaPar, type = c("b", "r"), xlim = c(0, 33), ylim = c(0, 10))
  # xyplot(shiftTitle~zeilen, data = MetaPar, type = c("b", "r"))

  # AnzZeilen <- 23
  height     <- predict(MetaRegHeight, newdata = data.frame(zeilen = AnzZeilen))
  shiftTitle <- predict(MetaRegShiftT, newdata = data.frame(zeilen = AnzZeilen))
  return(c(height, shiftTitle))
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Funktion 'getPlotUebers()'  -  Darstellung der allgemeinen Daten-Kennzahlen                     ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
getPlotUebers <- function(ProfileUebersicht, shiftTitle = 1.5, title = "", subtitle = "", ...) {

  # shiftTitle <- GPars[2]
  # ProfileUebersicht
  my.settings$layout.widths$right.padding <- 1

  # ProfileUebersicht$Ratio <- as.numeric(ProfileUebersicht$Obs.IdName.y) /
  #                            as.numeric(ProfileUebersicht$Obs.IdName.x)
  ProfileUebersicht$Ratio <- as.numeric(ProfileUebersicht$Obs.y) /
                             as.numeric(ProfileUebersicht$Obs.x)
  ProfileUebersicht$Ratio[which(ProfileUebersicht$Ratio == Inf)] <- NA

  if(all(is.na(ProfileUebersicht$Ratio))) {
    xlow  <- 0
    xhigh <- 1
  } else {
    xlow  <- min(ProfileUebersicht$Ratio, na.rm = TRUE)
    xhigh <- max(ProfileUebersicht$Ratio, na.rm = TRUE)
  }
  xdiff <- xhigh - xlow
  xlim1 <- xlow  - 0.1 * max(0.1, xdiff)
  xlim2 <- xhigh + 0.1 * max(0.1, xdiff)
  xdist <- xlim2 - xlim1
  # xsep  <- getTicDist(xdist)
  # xtic  <- seq(0, 5, xsep)
  xtic  <- pretty(x = c(xlim1, xlim2), n = PrettyN)
  ylim1 <- 0
  ylim2 <- nrow(ProfileUebersicht) + 1

  spaceLeft1 <- paste(rep(" ", 15), collapse = "")
  posLeft1   <- xlim1 - xdist * 0.04
  shiftVert  <-  0.22
  shiftXLab  <-  0.03 * xdist
  shiftYLab  <-  0.35

  PlotUebers <- xyplot(c(nrow(ProfileUebersicht):1)~ProfileUebersicht$Ratio,
                       # main = paste("Übersicht Daten", DataName),
                       main = title,
                       # sub  = paste("KCM-Läufe", paste(IdRun, collapse = ", ")),
                       sub  = subtitle,
                       xlab = "",
                       ylab = "",
                       xlim = c(xlim1, xlim2),
                       ylim = c(ylim1, ylim2),
                       scales = list(x = list(at = xtic,
                                              label = sprintf("%.0f%%", 100 * xtic)),
                                     y = list(at = c(nrow(ProfileUebersicht):1),
                                              label = paste(ProfileUebersicht$Descriptions,
                                                            spaceLeft1))),
                       par.settings=my.settings,
                       panel=function(x, y, ...) {
                         panel.grid(v = -1, h = 0)
                         panel.xyplot(x, y, ...)
                         i <- 3
                         for (i in c(1:nrow(ProfileUebersicht)))
                         {
                           # Absolute Zahlen in Spalte links von Grafik ............................
                           panel.text(posLeft1, nrow(ProfileUebersicht) - i + 1 + shiftVert,
                                      # format(as.numeric(ProfileUebersicht$Obs.IdName.x[i]),
                                      format(as.numeric(ProfileUebersicht$Obs.x[i]),
                                             big.mark = "'"), cex = 0.7, adj = 1)
                           if (i_ProfileData2) {
                             panel.text(posLeft1, nrow(ProfileUebersicht) - i + 1 - shiftVert,
                                        # format(as.numeric(ProfileUebersicht$Obs.IdName.y[i]),
                                        format(as.numeric(ProfileUebersicht$Obs.y[i]),
                                               big.mark = "'"), cex = 0.7, adj = 1)
                           }
                         }
                         # Verhältnis als Zahl in Grafik ...........................................
                         panel.text(x + shiftXLab, y + shiftYLab,
                                    sprintf("%.0f%%", 100 * ProfileUebersicht$Ratio), cex = 0.7)
                         # Angabe Titel/Inhalt der absoluten Zahlen ................................
                         # panel.text(xlim1 + xdist / 2, nrow(ProfileUebersicht) + shiftTitle,
                         #            paste("Veränderung von Lauf", IdRun[2],
                         #                  "relativ zu Lauf", IdRun[1]))
                       })
  # plot(PlotUebers)
  # dev.off()
  return(PlotUebers)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Funktion 'getPlotChar()'    -  Darstellung der Kennzahlen der Text-Attribute                    ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
getPlotChar <- function(ProfileChar, shiftTitle = 3.0, title = "", subtitle = "", ...) {

  my.settings$layout.widths$right.padding <- 18 # 12

  ProfileChar$RatioDistinct <- ProfileChar$distinct.y / ProfileChar$distinct.x
  ProfileChar$RatioCountNA  <- ProfileChar$countNA.y  / ProfileChar$countNA.x
  RatioCountNA <- ProfileChar$RatioCountNA[which(ProfileChar$RatioCountNA != Inf)]

  xlow  <- ifelse(all(is.na(c(ProfileChar$RatioDistinct, RatioCountNA))),
                  0.9,  min(c(ProfileChar$RatioDistinct, RatioCountNA), na.rm = TRUE))
  xhigh <- ifelse(all(is.na(c(ProfileChar$RatioDistinct, RatioCountNA))),
                  1.1,  max(c(ProfileChar$RatioDistinct, RatioCountNA), na.rm = TRUE))
  # xlow  <- min(c(ProfileChar$RatioDistinct, RatioCountNA), na.rm = TRUE)
  # xhigh <- max(c(ProfileChar$RatioDistinct, RatioCountNA), na.rm = TRUE)

  xdiff <- xhigh - xlow
  xlim1 <- xlow  - 0.1 * max(0.1, xdiff)
  xlim2 <- xhigh + 0.1 * max(0.1, xdiff)
  xdist <- xlim2 - xlim1
  # xsep  <- getTicDist(xdist)
  # xtic  <- seq(0, 5, xsep)
  xtic  <- pretty(x = c(xlim1, xlim2), n = PrettyN)
  ylim1 <- 0
  ylim2 <- nrow(ProfileChar) + 1

  spaceLeft1 <- paste(rep(" ", 25), collapse = "")
  spaceLeft2 <- paste(rep(" ", max(0, WidthNames - max(nchar(ProfileChar$name)))), collapse = "")
  ProfileChar$name <- paste(spaceLeft2, ProfileChar$name)

  posLeft1   <- xlim1 - xdist * 0.04
  posLeft2   <- xlim1 - xdist * 0.14
  posRight1  <- xlim2 + xdist * 0.20 # 0.15
  posRight2  <- xlim2 + xdist * 0.40 # 0.25
  shiftVert  <-  0.22
  shiftXLab  <-  0.03 * xdist
  shiftYLab  <-  0.35

  PlChar <- xyplot(c(nrow(ProfileChar):1)~ProfileChar$RatioDistinct,
                   # main = paste("Textfelder Daten", DataName),
                   main = title,
                   # sub  = paste("KCM-Läufe", paste(IdRun, collapse = ", ")),
                   sub  = subtitle,
                   xlab = "",
                   ylab = "",
                   xlim = c(xlim1, xlim2),
                   ylim = c(ylim1, ylim2),
                   scales = list(x = list(at = xtic,
                                          label = sprintf("%.0f%%", 100 * xtic)),
                                 y = list(col = AttrCol,
                                          at = c(nrow(ProfileChar):1),
                                          label = paste(ProfileChar$name, spaceLeft1))),
                   par.settings=my.settings,
                   panel=function(x, y, ...) {
                     for (i in c(1:nrow(ProfileChar)))
                     {
                       # Absolute Zahlen 'distinct' in Spalte links von Grafik .....................
                       panel.text(posLeft2, nrow(ProfileChar) - i + 1 + shiftVert,
                                  format(as.numeric(ProfileChar$distinct.x[i]), big.mark = "'"),
                                  cex = 0.7, adj = 1)
                       panel.text(posLeft2, nrow(ProfileChar) - i + 1 - shiftVert,
                                  format(as.numeric(ProfileChar$distinct.y[i]), big.mark = "'"),
                                  cex = 0.7, adj = 1)
                       # Relative Antile 'distinct' in Spalte links von Grafik .....................
                       panel.text(posLeft1, nrow(ProfileChar) - i + 1 + shiftVert,
                                  sprintf("%.0f%%", as.numeric(ProfileChar$distinct.x[i]) * 100 /
                                          as.numeric(Profile_1a[3, 3])), cex = 0.7, adj = 1)
                       if (i_ProfileData2) {
                         panel.text(posLeft1, nrow(ProfileChar) - i + 1 - shiftVert,
                                    sprintf("%.0f%%", as.numeric(ProfileChar$distinct.y[i]) * 100 /
                                            as.numeric(Profile_2a[3, 3])), cex = 0.7, adj = 1)
                       }
                       # Absolute Zahlen 'countNA' in Spalte rechts von Grafik .....................
                       # rote Farbe bei Wechsel von/zu 0
                       CurCol <- 1
                       if (i_ProfileData2) {
                         if (!is.na(ProfileChar$countNA.x[i]) & !is.na(ProfileChar$countNA.y[i])) {
                           if((ProfileChar$countNA.x[i] == 0 & ProfileChar$countNA.y[i]  > 0) |
                              (ProfileChar$countNA.x[i]  > 0 & ProfileChar$countNA.y[i] == 0)) CurCol <- 2
                         }
                       }
                       panel.text(posRight1, nrow(ProfileChar) - i + 1 + shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileChar$countNA.x[i]), big.mark = "'"))
                       if (i_ProfileData2) {
                         panel.text(posRight1, nrow(ProfileChar) - i + 1 - shiftVert,
                                    col = CurCol, cex = 0.7, adj = 1,
                                    format(as.numeric(ProfileChar$countNA.y[i]), big.mark = "'"))
                       }
                       # Relative Anteile 'countNA' in Spalte rechts von Grafik ....................
                       CurTxt <- sprintf("%.0f%%", as.numeric(ProfileChar$countNA.x[i]) * 100 /
                                         as.numeric(Profile_1a[3, 3]))
                       if (is.na(ProfileChar$countNA.x[i]) | ProfileChar$countNA.x[i] == 0) CurTxt <- "-"
                       panel.text(posRight2, nrow(ProfileChar) - i + 1 + shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)

                       if (i_ProfileData2) {
                         CurTxt <- sprintf("%.0f%%", as.numeric(ProfileChar$countNA.y[i]) * 100 /
                                           as.numeric(Profile_2a[3, 3]))
                         if (is.na(ProfileChar$countNA.y[i]) | ProfileChar$countNA.y[i] == 0) CurTxt <- "-"
                         panel.text(posRight2, nrow(ProfileChar) - i + 1 - shiftVert,
                                    CurTxt, cex = 0.7, adj = 1)
                       }
                     }

                     panel.grid(v = -1, h = 0)
                     panel.xyplot(x, y + shiftVert, ...)
                     panel.xyplot(ProfileChar$RatioCountNA, y - shiftVert, col = SwicaCols[4], ...)

                     # Verhältnis 'RatioDistinct' als Zahl in Grafik ...............................
                     panel.text(x + shiftXLab, y + shiftVert + shiftYLab,
                                sprintf("%.0f%%", 100 * ProfileChar$RatioDistinct), cex = 0.7)
                     # Verhältnis 'RatioCountNA' als Zahl in Grafik ................................
                     panel.text(ProfileChar$RatioCountNA + shiftXLab, y - shiftVert + shiftYLab,
                                sprintf("%.0f%%", 100 * ProfileChar$RatioCountNA), cex = 0.7)
                     # Angabe Titel/Inhalt der absoluten Zahlen ....................................
                     panel.text(posLeft2, nrow(ProfileChar) + 1.5, "Anzahl\n'distinct'",
                                cex = 0.7, font = 2, col = SwicaCols[1])
                     panel.text(posRight1, nrow(ProfileChar) + 1.5, "Anzahl\n'NAs'",
                                cex = 0.7, font = 2, col = SwicaCols[4], alpha = 1)
                     # panel.text(xlim1 + xdist / 2, nrow(ProfileChar) + shiftTitle,
                     #            paste("Veränderung von Lauf", IdRun[2],
                     #                  "relativ zu Lauf", IdRun[1]))
                   })
  return(PlChar)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Funktion 'getPlotNum()'     -  Darstellung der Kennzahlen der Zahlen-Attribute                  ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
getPlotNum <- function(ProfileNum, shiftTitle = 2.0, title = "", subtitle = "", ...) {

  my.settings$layout.widths$right.padding <- 30 # 24

  ProfileNum$RatioDistinct  <- ProfileNum$distinct.y  / ProfileNum$distinct.x
  ProfileNum$RatioCountNA   <- ProfileNum$countNA.y   / ProfileNum$countNA.x
  ProfileNum$RatioCountZero <- ProfileNum$countZero.y / ProfileNum$countZero.x
  RatioCountNA   <- ProfileNum$RatioCountNA[  which(ProfileNum$RatioCountNA   != Inf)]
  RatioCountZero <- ProfileNum$RatioCountZero[which(ProfileNum$RatioCountZero != Inf)]

  xlow  <- ifelse(all(is.na(c(ProfileNum$RatioDistinct, RatioCountNA, RatioCountZero))),
                  0.9,  min(c(ProfileNum$RatioDistinct, RatioCountNA, RatioCountZero), na.rm = TRUE))
  xhigh <- ifelse(all(is.na(c(ProfileNum$RatioDistinct, RatioCountNA, RatioCountZero))),
                  1.1,  max(c(ProfileNum$RatioDistinct, RatioCountNA, RatioCountZero), na.rm = TRUE))

  xdiff <- xhigh - xlow
  xlim1 <- xlow  - 0.1 * max(0.1, xdiff)
  xlim2 <- xhigh + 0.1 * max(0.1, xdiff)
  xdist <- xlim2 - xlim1
  # xsep  <- getTicDist(xdist)
  # xtic  <- seq(0, 5, xsep)
  xtic  <- pretty(x = c(xlim1, xlim2), n = PrettyN)
  ylim1 <- 0
  ylim2 <- nrow(ProfileNum) + 1

  spaceLeft1 <- paste(rep(" ", 30), collapse = "")
  spaceLeft2 <- paste(rep(" ", max(0, WidthNames - max(nchar(ProfileNum$name)))), collapse = "")
  ProfileNum$name <- paste(spaceLeft2, ProfileNum$name)

  posLeft1   <- xlim1 - xdist * 0.07
  posLeft2   <- xlim1 - xdist * 0.20
  posRight1  <- xlim2 + xdist * 0.25 # 0.15
  posRight2  <- xlim2 + xdist * 0.40 # 0.25
  posRight3  <- xlim2 + xdist * 0.65 # 0.43
  posRight4  <- xlim2 + xdist * 0.80 # 0.55
  shiftVert  <-  0.22
  shiftXLab  <-  0.03 * xdist
  shiftYLab  <-  0.35

  PlNum <- xyplot(c(nrow(ProfileNum):1)~ProfileNum$RatioDistinct,
                   # main = paste("Zahlen-Felder Daten", DataName),
                   main = title,
                   # sub  = paste("KCM-Läufe", paste(IdRun, collapse = ", ")),
                   sub  = subtitle,
                   xlab = "",
                   ylab = "",
                   xlim = c(xlim1, xlim2),
                   ylim = c(ylim1, ylim2),
                   scales = list(x = list(at = xtic,
                                          label = sprintf("%.0f%%", 100 * xtic)),
                                 y = list(col = AttrCol,
                                          at = c(nrow(ProfileNum):1),
                                          label = paste(ProfileNum$name, spaceLeft1))),
                   par.settings=my.settings,
                   panel=function(x, y, ...) {
                     for (i in c(1:nrow(ProfileNum)))
                     {
                       # Absolute Zahlen 'distinct' in Spalte links von Grafik .....................
                       panel.text(posLeft2, nrow(ProfileNum) - i + 1 + shiftVert,
                                  format(as.numeric(ProfileNum$distinct.x[i]), big.mark = "'"),
                                  cex = 0.7, adj = 1)
                       panel.text(posLeft2, nrow(ProfileNum) - i + 1 - shiftVert,
                                  format(as.numeric(ProfileNum$distinct.y[i]), big.mark = "'"),
                                  cex = 0.7, adj = 1)
                       # Relative Antile 'distinct' in Spalte links von Grafik .....................
                       panel.text(posLeft1, nrow(ProfileNum) - i + 1 + shiftVert,
                                  sprintf("%.0f%%", as.numeric(ProfileNum$distinct.x[i]) * 100 /
                                          as.numeric(Profile_1a[3, 3])), cex = 0.7, adj = 1)
                       if (i_ProfileData2) {
                         panel.text(posLeft1, nrow(ProfileNum) - i + 1 - shiftVert,
                                    sprintf("%.0f%%", as.numeric(ProfileNum$distinct.y[i]) * 100 /
                                            as.numeric(Profile_2a[3, 3])), cex = 0.7, adj = 1)
                       }
                       # Absolute Zahlen 'countNA' in Spalte rechts von Grafik .....................
                       CurCol <- 1
                       if (!is.na(ProfileNum$countNA.x[i]) & !is.na(ProfileNum$countNA.y[i])) {
                         if((ProfileNum$countNA.x[i] == 0 & ProfileNum$countNA.y[i] > 0) |
                            (ProfileNum$countNA.x[i]  > 0 & ProfileNum$countNA.y[i] == 0)) CurCol <- 2
                       }
                       panel.text(posRight1, nrow(ProfileNum) - i + 1 + shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileNum$countNA.x[i]), big.mark = "'"))
                       panel.text(posRight1, nrow(ProfileNum) - i + 1 - shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileNum$countNA.y[i]), big.mark = "'"))
                       # Relative Anteile 'countNA' in Spalte rechts von Grafik ....................
                       CurTxt <- sprintf("%.0f%%", as.numeric(ProfileNum$countNA.x[i]) * 100 /
                                         as.numeric(Profile_1a[3, 3]))
                       if (is.na(ProfileNum$countNA.x[i]) | ProfileNum$countNA.x[i] == 0) CurTxt <- "-"
                       panel.text(posRight2, nrow(ProfileNum) - i + 1 + shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)
                       if (i_ProfileData2) {
                         CurTxt <- sprintf("%.0f%%", as.numeric(ProfileNum$countNA.y[i]) * 100 /
                                           as.numeric(Profile_2a[3, 3]))
                       }
                       if (is.na(ProfileNum$countNA.y[i]) | ProfileNum$countNA.y[i] == 0) CurTxt <- "-"
                       panel.text(posRight2, nrow(ProfileNum) - i + 1 - shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)
                       # Absolute Zahlen 'countZero' in Spalte rechts von Grafik ...................
                       CurCol <- 1
                       if (!is.na(ProfileNum$countZero.x[i]) & !is.na(ProfileNum$countZero.y[i])) {
                         if((ProfileNum$countZero.x[i] == 0 & ProfileNum$countZero.y[i] > 0) |
                            (ProfileNum$countZero.x[i]  > 0 & ProfileNum$countZero.y[i] == 0)) CurCol <- 2
                       }
                       panel.text(posRight3, nrow(ProfileNum) - i + 1 + shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileNum$countZero.x[i]), big.mark = "'"))
                       panel.text(posRight3, nrow(ProfileNum) - i + 1 - shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileNum$countZero.y[i]), big.mark = "'"))
                       # Relative Anteile 'countZero' in Spalte rechts von Grafik ..................
                       CurTxt <- sprintf("%.0f%%", as.numeric(ProfileNum$countZero.x[i]) * 100 /
                                         as.numeric(Profile_1a[3, 3]))
                       if (is.na(ProfileNum$countZero.x[i]) | ProfileNum$countZero.x[i] == 0) CurTxt <- "-"
                       panel.text(posRight4, nrow(ProfileNum) - i + 1 + shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)
                       if (i_ProfileData2) {
                         CurTxt <- sprintf("%.0f%%", as.numeric(ProfileNum$countZero.y[i]) * 100 /
                                           as.numeric(Profile_2a[3, 3]))
                       }
                       if (is.na(ProfileNum$countZero.y[i]) | ProfileNum$countZero.y[i] == 0) CurTxt <- "-"
                       panel.text(posRight4, nrow(ProfileNum) - i + 1 - shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)
                     }
                     panel.grid(v = -1, h = 0)
                     panel.xyplot(x, y + shiftVert, ...)
                     panel.xyplot(ProfileNum$RatioCountNA, y - shiftVert, col = SwicaCols[4], ...)
                     panel.xyplot(ProfileNum$RatioCountZero, y, col = SwicaCols[6], ...)

                     # Verhältnis 'RatioDistinct' als Zahl in Grafik ...............................
                     panel.text(x + shiftXLab, y + shiftVert + shiftYLab,
                                sprintf("%.0f%%", 100 * ProfileNum$RatioDistinct), cex = 0.7)
                     # Verhältnis 'RatioCountNA' als Zahl in Grafik ................................
                     panel.text(ProfileNum$RatioCountNA + shiftXLab, y - shiftVert + shiftYLab,
                                sprintf("%.0f%%", 100 * ProfileNum$RatioCountNA), cex = 0.7)
                     # Verhältnis 'RatioCountZero' als Zahl in Grafik ..............................
                     panel.text(ProfileNum$RatioCountZero + shiftXLab, y + shiftYLab,
                                sprintf("%.0f%%", 100 * ProfileNum$RatioCountZero), cex = 0.7)
                     # Angabe Titel/Inhalt der absoluten Zahlen ....................................
                     panel.text(posLeft2, nrow(ProfileNum) + 1.5, "Anzahl\n'distinct'",
                                cex = 0.7, font = 2, col = SwicaCols[1])
                     panel.text(posRight1, nrow(ProfileNum) + 1.5, "Anzahl\n'NAs'",
                                cex = 0.7, font = 2, col = SwicaCols[4], alpha = 1)
                     panel.text(posRight3, nrow(ProfileNum) + 1.5, "Anzahl\n'0'",
                                cex = 0.7, font = 2, col = SwicaCols[6], alpha = 1)
                     # panel.text(xlim1 + xdist / 2, nrow(ProfileNum) + shiftTitle,
                     #            paste("Veränderung von Lauf", IdRun[2],
                     #                  "relativ zu Lauf", IdRun[1]))
                   })
  return(PlNum)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Funktion 'getPlotNum2()'    -  Darstellung der Wertebereiche der Zahlen-Attribute               ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
getPlotNum2 <- function(ProfileNum, shiftTitle = 2.0, title = "", subtitle = "", iDatum = 0, ...) {

  # Parameter-Test -----------------------------
# my.settings$layout.widths$strip.left <- 50
# my.settings$layout.widths$ylab.axis.padding <- 50
# my.settings$layout.widths$ylab              <- 70
# my.settings$axis.padding <- list(numeric = 30)
# iDatum <- 0
# lattice.options(axis.padding = list(factor = 10))
  # ProfileNum <- ProfilePersStat
  # Parameter-Test -----------------------------

  my.settings$layout.widths$right.padding     <- 25 #17

  xlow  <- ifelse(all(is.na(c(ProfileNum$min.x, ProfileNum$min.y))),
                  0.9,  min(c(ProfileNum$min.x, ProfileNum$min.y), na.rm = TRUE))
  xhigh <- ifelse(all(is.na(c(ProfileNum$max.x, ProfileNum$max.y))),
                  1.1,  max(c(ProfileNum$max.x, ProfileNum$max.y), na.rm = TRUE))
  # xlow  <- min(c(ProfileNum$min.x, ProfileNum$min.y), na.rm = TRUE)
  # xhigh <- max(c(ProfileNum$max.x, ProfileNum$max.y), na.rm = TRUE)

  xdiff <- xhigh - xlow
  xlim1 <- xlow  - 0.1 * max(0.1, xdiff)
  xlim2 <- xhigh + 0.1 * max(0.1, xdiff)
  xdist <- xlim2 - xlim1
  # xsep  <- getTicDist(xdist)
  # xtic  <- seq(0, 5, xsep)
  xtic  <- pretty(x = c(xlim1, xlim2), n = PrettyN)
  ylim1 <- 0
  ylim2 <- nrow(ProfileNum) + 1

  spaceLeft1 <- paste(rep(" ", 50), collapse = "")    # 24
  spaceLeft2 <- paste(rep(" ", max(0, WidthNames - max(nchar(ProfileNum$name)))), collapse = "")
  ProfileNum$name <- paste(spaceLeft2, ProfileNum$name)

  posLeft1   <- xlim1 - xdist * 0.10 # 0.06
  posLeft2   <- xlim1 - xdist * 0.30 # 0.13
  posLeft3   <- xlim1 - xdist * 0.50 # 0.20
  posRight1  <- xlim2 + xdist * 0.25 # 0.15
  posRight2  <- xlim2 + xdist * 0.45 # 0.25
  posRight3  <- xlim2 + xdist * 0.65 # 0.35
  shiftVert  <-  0.22
  shiftXLab  <-  0.03 * xdist
  shiftYLab  <-  0.35

  PlNum2 <- xyplot(c(nrow(ProfileNum):1)~ProfileNum$mean.x,
                   # main = paste("Wertebereiche Zahlen-Felder Daten", DataName),
                   main = title,
                   # sub  = paste("KCM-Läufe", paste(IdRun, collapse = ", ")),
                   sub  = subtitle,
                   xlab = "",
                   ylab = "",
                   xlim = c(xlim1, xlim2),
                   ylim = c(ylim1, ylim2),
                   # scales = list(x = list(at = seq(0, 200, xsep),
                   #                        label = format(seq(0, 200, xsep), big.mark = "'")),
                   scales = list(x = list(at = xtic,
                                          label = if (iDatum == 0) {
                                            format(xtic, big.mark = "'")
                                          } else {
                                            as.Date(as.numeric(xtic), origin = "1970-01-01")
                                          }),
                                 y = list(at = c(nrow(ProfileNum):1),
                                          label = paste(ProfileNum$name, spaceLeft1))),
                   par.settings=my.settings,
                   panel=function(x, y, ...) {
                     panel.grid(v = -1, h = 0)
                     for (i in c(1:nrow(ProfileNum)))
                     {
                       # pie(1:7, col = SwicaCols)
                       # Bereiche 25-Perzentil bis 75-Perzentil
                       if ("q75.x" %in% names(ProfileNum)) {
                         panel.lines(x=c(ProfileNum$q25.x[i], ProfileNum$q75.x[i]),
                                     y=c(y[i] + shiftVert, y[i] + shiftVert), lwd=4, lty=1,
                                     col.line=SwicaCols[3])
                         panel.lines(x=c(ProfileNum$q25.y[i], ProfileNum$q75.y[i]),
                                     y=c(y[i] - shiftVert, y[i] - shiftVert), lwd=4, lty=1,
                                     col.line=SwicaCols[3])
                       }
                       # Bereiche Minimum bis Maximum
                       panel.lines(x=c(ProfileNum$min.x[i], ProfileNum$max.x[i]),
                                   y=c(y[i] + shiftVert, y[i] + shiftVert), lwd=1, lty=1,
                                   col.line=SwicaCols[3])
                       panel.lines(x=c(ProfileNum$min.y[i], ProfileNum$max.y[i]),
                                   y=c(y[i] - shiftVert, y[i] - shiftVert), lwd=1, lty=1,
                                   col.line=SwicaCols[3])
                       # Median
                       panel.lines(x=c(ProfileNum$median.x[i], ProfileNum$median.x[i]),
                                   y=c(y[i] + shiftVert - 0.30, y[i] + shiftVert + 0.30),
                                   lwd=1, lty=1, col.line="blue")
                       panel.lines(x=c(ProfileNum$median.y[i], ProfileNum$median.y[i]),
                                   y=c(y[i] - shiftVert - 0.30, y[i] - shiftVert + 0.30),
                                   lwd=1, lty=1, col.line="blue")
                       # Minimum in Spalte links von Grafik ........................................
                       if (iDatum == 0) {
                         # txt1 <- format(as.numeric(ProfileNum$min.x[i]), big.mark = "'")
                         # txt2 <- format(as.numeric(ProfileNum$min.y[i]), big.mark = "'")
                         txt1 <- myRound(ProfileNum$min.x[i])
                         txt2 <- myRound(ProfileNum$min.y[i])
                       } else {
                         txt1 <- as.Date(as.numeric(ProfileNum$min.x[i]), origin = "1970-01-01")
                         txt2 <- as.Date(as.numeric(ProfileNum$min.y[i]), origin = "1970-01-01")
                       }
                       panel.text(posLeft3, nrow(ProfileNum) - i + 1 + shiftVert,
                                  txt1, cex = 0.7, adj = 1)
                       panel.text(posLeft3, nrow(ProfileNum) - i + 1 - shiftVert,
                                  txt2, cex = 0.7, adj = 1)
                       # 25 Perzentil in Spalte links von Grafik ...................................
                       if ("q25.x" %in% names(ProfileNum)) {
                         panel.text(posLeft2, nrow(ProfileNum) - i + 1 + shiftVert,
                                    myRound(ProfileNum$q25.x[i]),
                                    # format(as.numeric(ProfileNum$q25.x[i]), big.mark = "'"),
                                    cex = 0.7, adj = 1)
                         panel.text(posLeft2, nrow(ProfileNum) - i + 1 - shiftVert,
                                    myRound(ProfileNum$q25.y[i]),
                                    # format(as.numeric(ProfileNum$q25.y[i]), big.mark = "'"),
                                    cex = 0.7, adj = 1)
                       }
                       # 50 Perzentil in Spalte links von Grafik ...................................
                       if (iDatum == 0) {
                         # txt1 <- format(as.numeric(ProfileNum$median.x[i]), big.mark = "'")
                         # txt2 <- format(as.numeric(ProfileNum$median.y[i]), big.mark = "'")
                         txt1 <- myRound(ProfileNum$median.x[i])
                         txt2 <- myRound(ProfileNum$median.y[i])
                       } else {
                         txt1 <- as.Date(as.numeric(ProfileNum$median.x[i]), origin = "1970-01-01")
                         txt2 <- as.Date(as.numeric(ProfileNum$median.y[i]), origin = "1970-01-01")
                       }
                       panel.text(posLeft1, nrow(ProfileNum) - i + 1 + shiftVert,
                                  txt1, cex = 0.7, adj = 1)
                       panel.text(posLeft1, nrow(ProfileNum) - i + 1 - shiftVert,
                                  txt2, cex = 0.7, adj = 1)
                       # Mean Perzentil in Spalte rechts von Grafik ................................
                       if (iDatum == 0) {
                         # txt1 <- format(as.numeric(ProfileNum$mean.x[i]), big.mark = "'")
                         # txt2 <- format(as.numeric(ProfileNum$mean.y[i]), big.mark = "'")
                         txt1 <- myRound(ProfileNum$mean.x[i])
                         txt2 <- myRound(ProfileNum$mean.y[i])
                       } else {
                         txt1 <- as.Date(as.numeric(ProfileNum$mean.x[i]), origin = "1970-01-01")
                         txt2 <- as.Date(as.numeric(ProfileNum$mean.y[i]), origin = "1970-01-01")
                       }
                       panel.text(posRight1, nrow(ProfileNum) - i + 1 + shiftVert,
                                  txt1, cex = 0.7, adj = 1)
                       panel.text(posRight1, nrow(ProfileNum) - i + 1 - shiftVert,
                                  txt2, cex = 0.7, adj = 1)
                       # 75 Perzentil in Spalte rechts von Grafik ..................................
                       if ("q75.x" %in% names(ProfileNum)) {
                         panel.text(posRight2, nrow(ProfileNum) - i + 1 + shiftVert,
                                    myRound(ProfileNum$q75.x[i]),
                                    # format(signif(as.numeric(ProfileNum$q75.x[i]), 2), big.mark = "'"),
                                    cex = 0.7, adj = 1)
                         panel.text(posRight2, nrow(ProfileNum) - i + 1 - shiftVert,
                                    myRound(ProfileNum$q75.y[i]),
                                    # format(signif(as.numeric(ProfileNum$q75.y[i]), 2), big.mark = "'"),
                                    cex = 0.7, adj = 1)
                       }
                       # Maximum in Spalte links von Grafik ........................................
                       if (iDatum == 0) {
                         # txt1 <- format(as.numeric(ProfileNum$max.x[i]), big.mark = "'")
                         # txt2 <- format(as.numeric(ProfileNum$max.y[i]), big.mark = "'")
                         txt1 <- myRound(ProfileNum$max.x[i])
                         txt2 <- myRound(ProfileNum$max.y[i])
                       } else {
                         txt1 <- as.Date(as.numeric(ProfileNum$max.x[i]), origin = "1970-01-01")
                         txt2 <- as.Date(as.numeric(ProfileNum$max.y[i]), origin = "1970-01-01")
                       }
                       panel.text(posRight3, nrow(ProfileNum) - i + 1 + shiftVert,
                                  txt1, cex = 0.7, adj = 1)
                       panel.text(posRight3, nrow(ProfileNum) - i + 1 - shiftVert,
                                  txt2, cex = 0.7, adj = 1)
                     }

                     panel.xyplot(x, y + shiftVert, ...)
                     panel.xyplot(ProfileNum$mean.y, y - shiftVert, col = SwicaCols[4], ...)

                     # Angabe Titel/Inhalt der absoluten Zahlen ....................................
                     panel.text(posLeft3, nrow(ProfileNum) + 1.0, "Min.", adj = 1,
                                cex = 0.7, font = 2) #, col = SwicaCols[1])
                     if ("q25.x" %in% names(ProfileNum)) {
                       panel.text(posLeft2, nrow(ProfileNum) + 1.0, "25%", adj = 1,
                                  cex = 0.7, font = 2) #, col = SwicaCols[4])
                     }
                     panel.text(posLeft1, nrow(ProfileNum) + 1.0, "50%", adj = 1,
                                cex = 0.7, font = 2) #, col = SwicaCols[4])
                     panel.text(posRight1, nrow(ProfileNum) + 1.0, "Mean", adj = 1,
                                cex = 0.7, font = 2) #, col = SwicaCols[4])
                     if ("q75.x" %in% names(ProfileNum)) {
                       panel.text(posRight2, nrow(ProfileNum) + 1.0, "75%", adj = 1,
                                  cex = 0.7, font = 2) #, col = SwicaCols[4])
                     }
                     panel.text(posRight3, nrow(ProfileNum) + 1.0, "Max.", adj = 1,
                                cex = 0.7, font = 2) #, col = SwicaCols[4])
                     # panel.text(xlim1 + xdist / 2, nrow(ProfileNum) + shiftTitle,
                     #            paste("Wertebereiche Lauf", IdRun[1], "(obere Einträge)",
                     #                  "und", IdRun[2], "(untere Einträge)"))
                   })

  return(PlNum2)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Funktion 'getPlotFactor()'  -  Darstellung der Kennzahlen der Faktor-Attribute                  ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
getPlotFactor <- function(ProfileFactor, shiftTitle = 3.0, title = "", subtitle = "", ...) {

  my.settings$layout.widths$right.padding <- 24

  ProfileFactor$RatioCountNA  <- ProfileFactor$countNA.y  / ProfileFactor$countNA.x
  ProfileFactor$RatioDistinct <- ProfileFactor$distinct.y / ProfileFactor$distinct.x
  ProfileFactor$RatioLevels   <- ProfileFactor$levels.y   / ProfileFactor$levels.x
  RatioCountNA <- ProfileFactor$RatioCountNA[which(ProfileFactor$RatioCountNA != Inf)]

  xlow  <- ifelse(all(is.na(c(ProfileFactor$RatioDistinct, RatioCountNA, ProfileFactor$RatioLevels))),
                  0.9,  min(c(ProfileFactor$RatioDistinct, RatioCountNA, ProfileFactor$RatioLevels), na.rm = TRUE))
  xhigh <- ifelse(all(is.na(c(ProfileFactor$RatioDistinct, RatioCountNA, ProfileFactor$RatioLevels))),
                  1.1,  max(c(ProfileFactor$RatioDistinct, RatioCountNA, ProfileFactor$RatioLevels), na.rm = TRUE))
  # xlow  <- min(c(ProfileFactor$RatioDistinct, RatioCountNA, ProfileFactor$RatioLevels), na.rm = TRUE)
  # xhigh <- max(c(ProfileFactor$RatioDistinct, RatioCountNA, ProfileFactor$RatioLevels), na.rm = TRUE)

  xdiff <- xhigh - xlow
  xlim1 <- xlow  - 0.1 * max(0.1, xdiff)
  xlim2 <- xhigh + 0.1 * max(0.1, xdiff)
  xdist <- xlim2 - xlim1
  # xsep  <- getTicDist(xdist)
  # xtic  <- seq(0, 5, xsep)
  xtic  <- pretty(x = c(xlim1, xlim2), n = PrettyN)
  ylim1 <- 0
  ylim2 <- nrow(ProfileFactor) + 1

  spaceLeft1 <- paste(rep(" ", 25), collapse = "")
  spaceLeft2 <- paste(rep(" ", max(0, WidthNames - max(nchar(ProfileFactor$name)))), collapse = "")
  ProfileFactor$name <- paste(spaceLeft2, ProfileFactor$name)

  posLeft1   <- xlim1 - xdist * 0.09
  posLeft2   <- xlim1 - xdist * 0.29
  posRight1  <- xlim2 + xdist * 0.15
  posRight2  <- xlim2 + xdist * 0.25
  posRight3  <- xlim2 + xdist * 0.43
  posRight4  <- xlim2 + xdist * 0.59
  shiftVert  <-  0.22
  shiftXLab  <-  0.03 * xdist
  shiftYLab  <-  0.35

  PlFactor <- xyplot(c(nrow(ProfileFactor):1)~ProfileFactor$RatioDistinct,
                   # main = paste("Textfelder Daten", DataName),
                   main = title,
                   # sub  = paste("KCM-Läufe", paste(IdRun, collapse = ", ")),
                   sub  = subtitle,
                   xlab = "",
                   ylab = "",
                   xlim = c(xlim1, xlim2),
                   ylim = c(ylim1, ylim2),
                   scales = list(x = list(at = xtic,
                                          label = sprintf("%.0f%%", 100 * xtic)),
                                 y = list(col = AttrCol,
                                          at = c(nrow(ProfileFactor):1),
                                          label = paste(ProfileFactor$name, spaceLeft1))),
                   par.settings = my.settings,
                   panel=function(x, y, ...) {
                     for (i in c(1:nrow(ProfileFactor)))
                     {
                       # Absolute Zahlen 'distinct' in Spalte links von Grafik .....................
                       panel.text(posLeft2, nrow(ProfileFactor) - i + 1 + shiftVert,
                                  format(as.numeric(ProfileFactor$distinct.x[i]), big.mark = "'"),
                                  cex = 0.7, adj = 1)
                       panel.text(posLeft2, nrow(ProfileFactor) - i + 1 - shiftVert,
                                  format(as.numeric(ProfileFactor$distinct.y[i]), big.mark = "'"),
                                  cex = 0.7, adj = 1)

                       # Relative Antile 'distinct' in Spalte links von Grafik .....................
                       CurTxt <- ifelse(is.na(ProfileFactor$distinct.x[i]),
                                        "-",
                                        sprintf("%.0f%%", as.numeric(ProfileFactor$distinct.x[i]) * 100 /
                                          as.numeric(Profile_1a[3, 3])))
                       panel.text(posLeft1, nrow(ProfileFactor) - i + 1 + shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)

                       CurTxt <- ifelse(is.na(ProfileFactor$distinct.y[i]),
                                        "-",
                                        sprintf("%.0f%%", as.numeric(ProfileFactor$distinct.y[i]) * 100 /
                                          as.numeric(Profile_2a[3, 3])))
                       panel.text(posLeft1, nrow(ProfileFactor) - i + 1 - shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)

                       # Absolute Zahlen 'countNA' in Spalte rechts von Grafik .....................
                       CurCol <- 1
                       if (!is.na(ProfileFactor$countNA.x[i]) & !is.na(ProfileFactor$countNA.y[i])) {
                         if((ProfileFactor$countNA.x[i] == 0 & ProfileFactor$countNA.y[i] > 0) |
                            (ProfileFactor$countNA.x[i] > 0 & ProfileFactor$countNA.y[i] == 0)) CurCol <- 2
                       }
                       panel.text(posRight1, nrow(ProfileFactor) - i + 1 + shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileFactor$countNA.x[i]), big.mark = "'"))
                       panel.text(posRight1, nrow(ProfileFactor) - i + 1 - shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileFactor$countNA.y[i]), big.mark = "'"))

                       # Relative Anteile 'countNA' in Spalte rechts von Grafik ....................
                       CurTxt <- ifelse((is.na(ProfileFactor$countNA.x[i]) | ProfileFactor$countNA.x[i] == 0),
                                        "-",
                                        sprintf("%.0f%%", as.numeric(ProfileFactor$countNA.x[i]) * 100 /
                                                as.numeric(Profile_1a[3, 3])))
                       panel.text(posRight2, nrow(ProfileFactor) - i + 1 + shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)

                       CurTxt <- ifelse((is.na(ProfileFactor$countNA.y[i]) | ProfileFactor$countNA.y[i] == 0),
                                        "-",
                                        sprintf("%.0f%%", as.numeric(ProfileFactor$countNA.y[i]) * 100 /
                                                as.numeric(Profile_2a[3, 3])))
                       panel.text(posRight2, nrow(ProfileFactor) - i + 1 - shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)

                       # Absolute Zahlen 'Levels' in Spalte rechts von Grafik ......................
                       CurCol <- 1
                       if (!is.na(ProfileFactor$levels.x[i]) & !is.na(ProfileFactor$levels.y[i])) {
                         if((ProfileFactor$levels.x[i] == 0 & ProfileFactor$levels.y[i] > 0) |
                            (ProfileFactor$levels.x[i] > 0 & ProfileFactor$levels.y[i] == 0)) CurCol <- 2
                       }
                       panel.text(posRight3, nrow(ProfileFactor) - i + 1 + shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileFactor$levels.x[i]), big.mark = "'"))
                       panel.text(posRight3, nrow(ProfileFactor) - i + 1 - shiftVert,
                                  col = CurCol, cex = 0.7, adj = 1,
                                  format(as.numeric(ProfileFactor$levels.y[i]), big.mark = "'"))

                       # Relative Anteile 'Levels' in Spalte rechts von Grafik .....................
                       CurTxt <- ifelse((is.na(ProfileFactor$levels.x[i]) | ProfileFactor$levels.x[i] == 0),
                                        "-",
                                        sprintf("%.0f%%", as.numeric(ProfileFactor$levels.x[i]) * 100 /
                                                as.numeric(Profile_1a[3, 3])))
                       panel.text(posRight4, nrow(ProfileFactor) - i + 1 + shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)

                       CurTxt <- ifelse((is.na(ProfileFactor$levels.y[i]) | ProfileFactor$levels.y[i] == 0),
                                        "-",
                                        sprintf("%.0f%%", as.numeric(ProfileFactor$levels.y[i]) * 100 /
                                                as.numeric(Profile_2a[3, 3])))
                       panel.text(posRight4, nrow(ProfileFactor) - i + 1 - shiftVert,
                                  CurTxt, cex = 0.7, adj = 1)
                     }
                     panel.grid(v = -1, h = 0)
                     panel.xyplot(x, y + shiftVert, ...)
                     panel.xyplot(ProfileFactor$RatioCountNA, y - shiftVert, col = SwicaCols[4], ...)
                     panel.xyplot(ProfileFactor$RatioLevels,  y, col = SwicaCols[6], ...)

                     # Verhältnis 'RatioDistinct' als Zahl in Grafik ...............................
                     panel.text(x + shiftXLab, y + shiftVert + shiftYLab,
                                sprintf("%.0f%%", 100 * ProfileFactor$RatioDistinct), cex = 0.7)

                     # Verhältnis 'RatioCountNA' als Zahl in Grafik ................................
                     panel.text(ProfileFactor$RatioCountNA + shiftXLab, y - shiftVert + shiftYLab,
                                sprintf("%.0f%%", 100 * ProfileFactor$RatioCountNA), cex = 0.7)

                     # Verhältnis 'RatioLevels' als Zahl in Grafik ................................
                     panel.text(ProfileFactor$RatioLevels + shiftXLab, y - shiftVert,
                                sprintf("%.0f%%", 100 * ProfileFactor$RatioLevels), cex = 0.7)

                     # Angabe Titel/Inhalt der absoluten Zahlen ....................................
                     panel.text(posLeft2, nrow(ProfileFactor) + 1.5, "Anzahl\n'distinct'",
                                cex = 0.7, font = 2, col = SwicaCols[1])
                     panel.text(posRight1, nrow(ProfileFactor) + 1.5, "Anzahl\n'NAs'",
                                cex = 0.7, font = 2, col = SwicaCols[4], alpha = 1)
                     panel.text(posRight3, nrow(ProfileFactor) + 1.5, "Anzahl\nLevels",
                                cex = 0.7, font = 2, col = SwicaCols[6], alpha = 1)
                     # panel.text(xlim1 + xdist / 2, nrow(ProfileFactor) + shiftTitle,
                     #            paste("Veränderung von Lauf", IdRun[2],
                     #                  "relativ zu Lauf", IdRun[1]))
                   })
  return(PlFactor)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
}
#
# VORBEREITUNGEN -----------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------
```

---
title: `r Title`
author: `r Author`
---

```{r DatenpaketeAufbereiten, echo=FALSE, eval=TRUE, include=FALSE}
# --------------------------------------------------------------------------------------------------
# Datensätze (Datensatz) aufbereiten ...............................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_ProfileData2) {
  #
  # Zwei Datensätze vorhanden
  ProfileUebersicht <- merge(Profile_1a[-c(1, 2), head(.SD, 1), by = ID],
                             Profile_2a[-c(1, 2), head(.SD, 1), by = ID][, -"Descriptions"],
                             by  = "ID", all = TRUE)

  #
  ProfileChar        <- merge(Profile_1b, Profile_2b, by = "name", all = TRUE)
  ProfileNum         <- merge(Profile_1c, Profile_2c, by = "name", all = TRUE)
  ProfileInt         <- merge(Profile_1f, Profile_2f, by = "name", all = TRUE)
  ProfileCharLikeNum <- merge(Profile_1g, Profile_2g, by = "name", all = TRUE)
  ProfileFactor      <- merge(Profile_1d, Profile_2d, by = "name", all = TRUE)
  ProfileDate        <- merge(Profile_1e, Profile_2e, by = "name", all = TRUE)
  #
} else {
  #
  # Ein Datensatz vorhanden
  ProfileUebersicht  <- Profile_1a[-c(1, 2), head(.SD, 1), by = ID]
  ProfileChar        <- Profile_1b
  ProfileNum         <- Profile_1c
  ProfileInt         <- Profile_1f
  ProfileCharLikeNum <- Profile_1g
  ProfileFactor      <- Profile_1d
  ProfileDate        <- Profile_1e
  #
}
#
i_DataChar                <- ifelse(nrow(ProfileChar)        > 0, 1, 0)
i_DataNum                 <- ifelse(nrow(ProfileNum)         > 0, 1, 0)
i_DataInt                 <- ifelse(nrow(ProfileInt)         > 0, 1, 0)
i_DataCharLikeNum         <- ifelse(nrow(ProfileCharLikeNum) > 0, 1, 0)
i_DataFactor              <- ifelse(nrow(ProfileFactor)      > 0, 1, 0)
i_DataDate                <- ifelse(nrow(ProfileDate)        > 0, 1, 0)
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# --------------------------------------------------------------------------------------------------
```

```{r GrafikenDefinieren, echo=FALSE, eval=TRUE, include=FALSE}
# --------------------------------------------------------------------------------------------------
# Grafiken aufbereiten und abspeichern -------------------------------------------------------------
# -- Grafiken nur bei zwei Datensätzen                                                            --
# -- für nur einen Datensatz wären Grafiken der Wertebereiche noch am ehesten sinnvoll            --
if (i_ProfileData2) {

title    <- paste("Veränderung Datenobjekt", BeschreibungDaten1, "a)",
                  "relativ zu Lauf", BeschreibungDaten2, "b)")
subtitle <- paste("Zeilen von a) oben, und b) unten")
#
# Temporären Ordner erstellen 'tempDir' resp. Inhalt löschen                                      ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
tempDir <- "TmpDir_zu_loeschen"
if (dir.exists(tempDir)) {
  unlink(file.path(tempDir, "*"))
} else {
  dir.create(tempDir)
}
# while ( tempDir %in% dirs )
# {
#   tempDir <- paste0(tempDir, "A")
# }
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
#
# Kennzahlen   Allgemein mit 'getPlotUebers()'              -- PlotUebers.png                     ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
LenCurAttr   <- nrow(ProfileUebersicht)
NPartsUebers <- ceiling(LenCurAttr / MaxN)
#
if (LenCurAttr > 0) {
  j <- 1
  for (j in 1:NPartsUebers)
  {
    CurNpartsUebers      <- ifelse(j < 10, paste0("0", j), j)
    CurAttr              <- c((MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j))
    CurProfileUebersicht <- ProfileUebersicht[CurAttr, ]
    AttrCol    <- rep(1, nrow(CurProfileUebersicht))
    GPars      <- getGraphParam(nrow(CurProfileUebersicht))
    PlotUebers <- getPlotUebers(CurProfileUebersicht, shiftTitle, title, subtitle)
    pfilen     <- file.path(tempDir, paste0("PlotUebers", CurNpartsUebers, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotUebers)
    dev.off()
    rm(PlotUebers)
  }
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Kennzahlen   Text-Attribute mit 'getPlotChar()'           -- PlotChar.png                       ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1b$name, Profile_2b$name))

CurAttr0   <- CurAttr0[order(CurAttr0)]
LenCurAttr <- length(CurAttr0)
NPartsChar <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1b)\n+ nrow(Profile_2b)\n> 0) {
if (LenCurAttr > 0) {
  j <- 1
  for (j in 1:NPartsChar)
  {
    CurNpartsChar <- ifelse(j < 10, paste0("0", j), j)
    CurAttr       <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileCharX <- ProfileChar[ProfileChar$name %in% CurAttr, ]
    ProfileCharX <- ProfileCharX[order(ProfileCharX$name), ]
    AttrCol      <- rep(1, nrow(ProfileCharX))
    #
    GPars    <- getGraphParam(nrow(ProfileCharX))
    PlotChar <- getPlotChar(ProfileCharX, shiftTitle, title, subtitle)
    pfilen   <- file.path(tempDir, paste0("PlotChar", CurNpartsChar, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotChar)
    dev.off()
    rm(PlotChar)
    rm(ProfileCharX)
  }
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Kennzahlen   Zahlen-Attribute mit 'getPlotNum()'          -- PlotNum.png                        ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1c$name, Profile_2c$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr <- length(CurAttr0)
NPartsNum  <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1c) + nrow(Profile_2c) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsNum)
  {
    CurNpartsNum <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileNumX <- ProfileNum[ProfileNum$name %in% CurAttr, ]
    ProfileNumX <- ProfileNumX[order(ProfileNumX$name),]
    AttrCol     <- rep(1, nrow(ProfileNumX))
    #
    GPars   <- getGraphParam(nrow(ProfileNumX))
    PlotNum <- getPlotNum(ProfileNumX, shiftTitle, title, subtitle)
    pfilen  <- file.path(tempDir, paste0("PlotNum", CurNpartsNum, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotNum)
    dev.off()
    rm(PlotNum)
    rm(ProfileNumX)
  }
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Wertebereich Zahlen-Attribute mit 'getPlotNum2()'         -- PlotWerteBerNum.png                ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1c$name, Profile_2c$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr        <- length(CurAttr0)
NPartsWerteBerNum <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1c) + nrow(Profile_2c) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsWerteBerNum)
  {
    CurNpartsNum <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileNumX <- ProfileNum[ProfileNum$name %in% CurAttr, ]
    ProfileNumX <- ProfileNumX[order(ProfileNumX$name),]
    AttrCol     <- rep(1, nrow(ProfileNumX))
    #
    GPars   <- getGraphParam(nrow(ProfileNumX))
    PlotNum <- getPlotNum2(ProfileNumX, shiftTitle, title, subtitle)
    pfilen  <- file.path(tempDir, paste0("PlotWerteBerNum", CurNpartsNum, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotNum)
    dev.off()
    rm(PlotNum)
    rm(ProfileNumX)
  }
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Kennzahlen   Integer-Attribute mit 'getPlotNum()'         -- PlotInt.png                        ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1f$name, Profile_2f$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr <- length(CurAttr0)
NPartsInt  <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1f) + nrow(Profile_2f) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsInt)
  {
    CurNpartsInt <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileIntX <- ProfileInt[ProfileInt$name %in% CurAttr, ]
    ProfileIntX <- ProfileIntX[order(ProfileIntX$name),]
    AttrCol     <- rep(1, nrow(ProfileIntX))
    #
    GPars   <- getGraphParam(nrow(ProfileIntX))
    PlotInt <- getPlotNum(ProfileIntX, shiftTitle, title, subtitle)
    pfilen  <- file.path(tempDir, paste0("PlotInt", CurNpartsInt, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotInt)
    dev.off()
    rm(PlotInt)
    rm(ProfileIntX)
  }
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Wertebereich Integer-Attribute mit 'getPlotNum2()'        -- PlotWerteBerInt.png                ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1f$name, Profile_2f$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr        <- length(CurAttr0)
NPartsWerteBerInt <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1f) + nrow(Profile_2f) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsWerteBerInt)
  {
    CurNpartsInt <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileIntX <- ProfileInt[ProfileInt$name %in% CurAttr, ]
    ProfileIntX <- ProfileIntX[order(ProfileIntX$name),]
    AttrCol     <- rep(1, nrow(ProfileIntX))
    #
    GPars   <- getGraphParam(nrow(ProfileIntX))
    PlotInt <- getPlotNum2(ProfileIntX, shiftTitle, title, subtitle)
    pfilen  <- file.path(tempDir, paste0("PlotWerteBerInt", CurNpartsInt, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotInt)
    dev.off()
    rm(PlotInt)
    rm(ProfileIntX)
  }
}
#
## GrafikDaten vorbereiten  --  Profile_1f, Profile_2f  --  alle                                   ..{{{
## xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
##
#ProfileInt <- merge(Profile_1f, Profile_2f, by = "name", all = TRUE)
#ProfileInt <- ProfileInt[order(ProfileInt$name), ]
##
## Attribute die in Modellen verwendet werden sollen farblich hervorgehoben werden.
#AttrCol <- rep(1, nrow(ProfileInt))
## ProfileInt$name %in% AttrModelC
##
## vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
##}}}
#if (nrow(ProfileInt) > 0) {
#  GPars   <- getGraphParam(nrow(ProfileInt))
#  PlotWerteBerInt <- getPlotNum2(ProfileInt, shiftTitle, title, subtitle)
#  pfilen  <- file.path(tempDir, "PlotWerteBerInt.png")
#  png(filename = pfilen
#      , width = 9, height = GPars[1], units = "in"
#      , res = 300)
#  print(PlotWerteBerInt)
#  dev.off()
#  rm(PlotWerteBerInt)
#}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Kennzahlen   Text-wie-Zahl-Attribute mit 'getPlotNum()'   -- PlotCharLikeNum.png                ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1g$name, Profile_2g$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr <- length(CurAttr0)
NPartsCharLikeNum  <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1g) + nrow(Profile_2g) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsCharLikeNum)
  {
    CurNpartsCharLikeNum <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileCharLikeNumX <- ProfileCharLikeNum[ProfileCharLikeNum$name %in% CurAttr, ]
    ProfileCharLikeNumX <- ProfileCharLikeNumX[order(ProfileCharLikeNumX$name),]
    AttrCol <- rep(1, nrow(ProfileCharLikeNumX))
    #
    GPars   <- getGraphParam(nrow(ProfileCharLikeNumX))
    PlotCharLikeNum <- getPlotNum(ProfileCharLikeNumX, shiftTitle, title, subtitle)
    pfilen  <- file.path(tempDir, paste0("PlotCharLikeNum", CurNpartsCharLikeNum, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotCharLikeNum)
    dev.off()
    rm(PlotCharLikeNum)
    rm(ProfileCharLikeNumX)
  }
}
#
## GrafikDaten vorbereiten  --  Profile_1g, Profile_2g  --  alle                                   ..{{{
## xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
##
#ProfileCharLikeNum <- merge(Profile_1g, Profile_2g, by = "name", all = TRUE)
#ProfileCharLikeNum <- ProfileCharLikeNum[order(ProfileCharLikeNum$name), ]
##
## Attribute die in Modellen verwendet werden sollen farblich hervorgehoben werden.
#AttrCol <- rep(1, nrow(ProfileCharLikeNum))
## ProfileCharLikeNum$name %in% AttrModelC
##
## vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
##}}}
#if (nrow(ProfileCharLikeNum) > 0) {
#  GPars   <- getGraphParam(nrow(ProfileCharLikeNum))
#  # PlotCharLikeNum <- getPlotNum(ProfileCharLikeNum, GPars[2])
#  PlotCharLikeNum <- getPlotNum(ProfileCharLikeNum, shiftTitle, title, subtitle)
#  pfilen  <- file.path(tempDir, "PlotCharLikeNum.png")
#  png(filename = pfilen
#      , width = 9, height = GPars[1], units = "in"
#      # , quality = 100
#      , res = 300)
#  print(PlotCharLikeNum)
#  dev.off()
#  rm(PlotCharLikeNum)
#}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Wertebereich Text-wie-Zahl-Attribute mit 'getPlotNum2()'  -- PlotWerteBerCharLikeNum.png        ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1g$name, Profile_2g$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr        <- length(CurAttr0)
NPartsWerteBerCharLikeNum <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1g) + nrow(Profile_2g) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsWerteBerCharLikeNum)
  {
    CurNpartsCharLikeNum <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileCharLikeNumX <- ProfileCharLikeNum[ProfileCharLikeNum$name %in% CurAttr, ]
    ProfileCharLikeNumX <- ProfileCharLikeNumX[order(ProfileCharLikeNumX$name),]
    AttrCol <- rep(1, nrow(ProfileCharLikeNumX))
    #
    GPars   <- getGraphParam(nrow(ProfileCharLikeNumX))
    PlotCharLikeNum <- getPlotNum2(ProfileCharLikeNumX, shiftTitle, title, subtitle)
    pfilen  <- file.path(tempDir, paste0("PlotWerteBerCharLikeNum", CurNpartsCharLikeNum, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotCharLikeNum)
    dev.off()
    rm(PlotCharLikeNum)
    rm(ProfileCharLikeNumX)
  }
}
#
## GrafikDaten vorbereiten  --  Profile_1g, Profile_2g  -- alle                                    ..{{{
## xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
##
#ProfileCharLikeNum <- merge(Profile_1g, Profile_2g, by = "name", all = TRUE)
#ProfileCharLikeNum <- ProfileCharLikeNum[order(ProfileCharLikeNum$name), ]
##
## Attribute die in Modellen verwendet werden sollen farblich hervorgehoben werden.
#AttrCol <- rep(1, nrow(ProfileCharLikeNum))
## ProfileCharLikeNum$name %in% AttrModelC
##
## vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
##}}}
#if (nrow(ProfileCharLikeNum) > 0) {
#  GPars           <- getGraphParam(nrow(ProfileCharLikeNum))
#  PlotCharLikeNum <- getPlotNum2(ProfileCharLikeNum, shiftTitle, title, subtitle)
#  pfilen          <- file.path(tempDir, "PlotWerteBerCharLikeNum.png")
#  png(filename = pfilen
#      , width = 9, height = GPars[1], units = "in"
#      , res = 300)
#  print(PlotCharLikeNum)
#  dev.off()
#  rm(PlotCharLikeNum)
#}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Kennzahlen   Faktor-Attribute mit 'getPlotFactor()'       -- PlotFactor.png                     ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1d$name, Profile_2d$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr <- length(CurAttr0)
NPartsFactor  <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1d) + nrow(Profile_2d) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsFactor)
  {
    CurNpartsFactor <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileFactorX <- ProfileFactor[ProfileFactor$name %in% CurAttr, ]
    ProfileFactorX <- ProfileFactorX[order(ProfileFactorX$name),]
    AttrCol        <- rep(1, nrow(ProfileFactorX))
    #
    GPars      <- getGraphParam(nrow(ProfileFactorX))
    PlotFactor <- getPlotFactor(ProfileFactorX, shiftTitle, title, subtitle)
    pfilen     <- file.path(tempDir, paste0("PlotFactor", CurNpartsFactor, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotFactor)
    dev.off()
    rm(PlotFactor)
    rm(ProfileFactorX)
  }
}
#
## GrafikDaten vorbereiten  --  Profile_1d, Profile_2d  --  alle                                   ..{{{
## xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
##
#ProfileFactor <- merge(Profile_1d, Profile_2d, by = "name", all = TRUE)
#ProfileFactor <- ProfileFactor[order(ProfileFactor$name), ]
##
## Attribute die in Modellen verwendet werden sollen farblich hervorgehoben werden.
#AttrCol <- rep(1, nrow(ProfileFactor))
## ProfileFactor$name %in% AttrModelC
##
## vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
##}}}
#if (nrow(ProfileFactor) > 0) {
#  GPars      <- getGraphParam(nrow(ProfileFactor))
#  PlotFactor <- getPlotFactor(ProfileFactor, shiftTitle, title, subtitle)
#  pfilen     <- file.path(tempDir, "PlotFactor.png")
#  png(filename = pfilen
#      , width = 9, height = GPars[1], units = "in"
#      , res = 300)
#  print(PlotFactor)
#  dev.off()
#  rm(PlotFactor)
#}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Kennzahlen   Datum-Attribute mit 'getPlotDate()'          -- PlotDate.png                       ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1e$name, Profile_2e$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr <- length(CurAttr0)
NPartsDate  <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1e) + nrow(Profile_2e) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsDate)
  {
    CurNpartsDate <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileDateX <- ProfileDate[ProfileDate$name %in% CurAttr, ]
    ProfileDateX <- ProfileDateX[order(ProfileDateX$name),]
    AttrCol      <- rep(1, nrow(ProfileDateX))
    #
    GPars    <- getGraphParam(nrow(ProfileDateX))
    PlotDate <- getPlotNum(ProfileDateX, shiftTitle, title, subtitle)
    pfilen   <- file.path(tempDir, paste0("PlotDate", CurNpartsDate, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotDate)
    dev.off()
    rm(PlotDate)
    rm(ProfileDateX)
  }
}
#
## GrafikDaten vorbereiten  --  Profile_1e, Profile_2e  --  alle                                   ..{{{
## xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
##
#ProfileDate <- merge(Profile_1e, Profile_2e, by = "name", all = TRUE)
#ProfileDate <- ProfileDate[order(ProfileDate$name), ]
##
## Attribute die in Modellen verwendet werden sollen farblich hervorgehoben werden.
#AttrCol <- rep(1, nrow(ProfileDate))
## ProfileDate$name %in% AttrModelC
##
## vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
##}}}
#if (nrow(ProfileDate) > 0) {
#  GPars   <- getGraphParam(nrow(ProfileDate))
#  PlotDate <- getPlotNum(ProfileDate, shiftTitle, title, subtitle)
#  pfilen   <- file.path(tempDir, "PlotDate.png")
#  png(filename = pfilen
#      , width = 9, height = GPars[1], units = "in"
#      , res = 300)
#  print(PlotDate)
#  dev.off()
#  rm(PlotDate)
#}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Wertebereich Datum-Attribute mit 'getPlotDate2()'         -- PlotWerteBerDate.png               ..{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
CurAttr0 <- unique(c(Profile_1e$name, Profile_2e$name))
CurAttr0 <- CurAttr0[order(CurAttr0)]

LenCurAttr        <- length(CurAttr0)
NPartsWerteBerDate <- ceiling(LenCurAttr / MaxN)

# if (nrow(Profile_1e) + nrow(Profile_2e) > 0) {
if (length(CurAttr0) > 0) {
  j <- 1
  for (j in 1:NPartsWerteBerDate)
  {
    CurNpartsDate <- ifelse(j < 10, paste0("0", j), j)
    CurAttr      <- CurAttr0[(MaxN * (j-1) + 1) : min(LenCurAttr, MaxN * j)]
    #
    ProfileDateX <- ProfileDate[ProfileDate$name %in% CurAttr, ]
    ProfileDateX <- ProfileDateX[order(ProfileDateX$name),]
    AttrCol      <- rep(1, nrow(ProfileDateX))
    #
    GPars    <- getGraphParam(nrow(ProfileDateX))
    PlotDate <- getPlotNum2(ProfileDateX, shiftTitle, title, subtitle)
    pfilen   <- file.path(tempDir, paste0("PlotWerteBerDate", CurNpartsDate, ".png"))
    png(filename = pfilen
        , width = 9, height = GPars[1], units = "in"
        , res = 300)
    print(PlotDate)
    dev.off()
    rm(PlotDate)
    rm(ProfileDateX)
  }
}
#
## GrafikDaten vorbereiten  --  Profile_1e, Profile_2e  --  alle                                   ..{{{
## xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
##
#ProfileDate <- merge(Profile_1e, Profile_2e, by = "name", all = TRUE)
#ProfileDate <- ProfileDate[order(ProfileDate$name), ]
##
## Attribute die in Modellen verwendet werden sollen farblich hervorgehoben werden.
#AttrCol <- rep(1, nrow(ProfileDate))
## ProfileDate$name %in% AttrModelC
##
## vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
##}}}
#if (nrow(ProfileDate) > 0) {
#  GPars   <- getGraphParam(nrow(ProfileDate))
#  PlotDate <- getPlotNum2(ProfileDate, shiftTitle, title, subtitle, iDatum = 1)
#  pfilen   <- file.path(tempDir, "PlotWerteBerDate.png")
#  png(filename = pfilen
#      , width = 9, height = GPars[1], units = "in"
#      , res = 300)
#  print(PlotDate)
#  dev.off()
#  rm(PlotDate)
#}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
}
#
# VORBEREITUNGEN -----------------------------------------------------------------------------------
# --------------------------------------------------------------------------------------------------
```

# Analyse Daten-Profiling{-}
`r if (i_ProfileData2) {
  paste("Es wuden die Datensätze der Dateien \\newline", fn_Data1, "'a)' und \\newline", fn_Data2,
  "'b)' untersucht.")
} else {
  paste("Es wude der Datensatz der Datei", fn_Data1, "untersucht.")
}`

Mit diesem Report zeigt ein grobes, automatisches Daten-Profiling.
Es können ein oder zwei Datensätze betrachtet werden.

Die Datenattribute werden nach Datentyp unterschieden und ausgewertet.
Als erste Übersicht werden die Anzahl und Anteile der Attribute nach Datentyp ausgegeben.
Danach werden für jeden Datentyp die Anzahl verschiedener Werte, die Anzahl NA aufgeführt sowie ein
Indikator der für nicht-numerische Attribute zeigt ob der Inhalt als Zahl interpretiert werden kann.

Bei Datentypen mit einem Wertebereich werden diese ebenfalls analysiert.

Bei der Angabe von zwei Datensätzen werden die Kennzahlen grafisch dargestellt womit die
Unterschiede zwischen den Daten augenfälliger werden.


\newpage

# Übersicht allgemein
In dieser ersten Übersicht werden allgmeine Metadaten des Datensatzes aufgezeigt.


```{r plotUebersTable, echo=FALSE, eval=TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle erstellen ................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_ProfileData2) {

# Zwei Datensätze
  TableUebersicht_1       <- ProfileUebersicht[ProfileUebersicht$ID %in% c(3:4),  c(2, 3, 4, 7, 8)]
  TableUebersicht_2       <- ProfileUebersicht[ProfileUebersicht$ID %in% c(5:10), c(2, 3, 4, 7, 8)]
  TableUebersicht_2$Ant.x <- sprintf("%.0f%%", as.numeric(TableUebersicht_2$Ant.x) * 100)
  TableUebersicht_2$Ant.y <- sprintf("%.0f%%", as.numeric(TableUebersicht_2$Ant.y) * 100)
  TableUebersicht_3       <- ProfileUebersicht[ProfileUebersicht$ID > 10, c(2, 3, 4, 7, 8)]
  TableUebersicht_3$Ant.x <- "-"
  TableUebersicht_3$Ant.y <- "-"
  TableUebersicht_3       <- unique(TableUebersicht_3)
  TableUebersicht         <- rbind(TableUebersicht_1, TableUebersicht_2, TableUebersicht_3, fill = TRUE)
  # TableUebersicht$name.x  <- NULL
  TableUebersicht$Obs.x   <- format(as.numeric(TableUebersicht$Obs.x), big.mark = "'")
  TableUebersicht$Obs.y   <- format(as.numeric(TableUebersicht$Obs.y), big.mark = "'")

  names(TableUebersicht)  <- c("Kennzahl", "a) Anzahl", "a) Anteil", "b) Anzahl", "b) Anteil")
  # ColNamesTable           <- gsub("a) ", "", names(TableUebersicht))
  # ColNamesTable           <- gsub("b) ", "", ColNamesTable)

  if (OutputFormat == "pdf") {
    names(TableUebersicht)  <- c("Kennzahl", "Anzahl", "Anteil", "Anzahl", "Anteil")
    # ColNamesTable           <- names(TableUebersicht)
    HeaderAboveStr          <- c("", "Datei a)" = 2, "Datei b)" = 2)
  }

} else {

# Ein Datensatz
  TableUebersicht_1      <- ProfileUebersicht[ProfileUebersicht$ID %in% c(3:4),  c(2, 3, 4)]
  TableUebersicht_2      <- ProfileUebersicht[ProfileUebersicht$ID %in% c(5:10), c(2, 3, 4)]
  TableUebersicht_2$Ant  <- sprintf("%.0f%%", as.numeric(TableUebersicht_2$Ant) * 100)
  TableUebersicht_3      <- ProfileUebersicht[ProfileUebersicht$ID > 10, c(2, 3, 4)]
  TableUebersicht_3$Ant  <- "-"
  TableUebersicht_3      <- unique(TableUebersicht_3)
  TableUebersicht        <- rbind(TableUebersicht_1, TableUebersicht_2, TableUebersicht_3, fill = TRUE)
  TableUebersicht$Obs    <- format(as.numeric(TableUebersicht$Obs), big.mark = "'")

  names(TableUebersicht) <- c("Kennzahl", "Anzahl", "Anteil")
  # ColNamesTable          <- names(TableUebersicht)
  HeaderAboveStr         <- NULL
}
# head(TableUebersicht) #                                                                         ..{{{
#                       Kennzahl a) Anzahl a) Anteil b) Anzahl b) Anteil
# 1:      Kollektivgrösse (Nrow)    10'000         -     2'895         -
# 2:     Anzahl Attribute (Ncol)        76         -        78         -
# 3: Anzahl numerische Attribute        24       32%        27       35%
# 4:    Anzahl Integer-Attribute         2        3%         1        1%
# 5:     Anzahl Faktor-Attribute        41       54%        41       53%
# 6:       Anzahl Text-Attribute         5        7%         5        6%
#}}}
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
cap <- "Datenübersicht"
if (OutputFormat == "pdf") {

  knitr::kable(TableUebersicht, caption=cap,
               row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
               format="latex", linesep=c(rep("", nrow(TableUebersicht)), "\\addlinespace")
               ) %>%
              # ,
              # escape = FALSE, col.names = linebreak(ColNamesTable, align = "c")) %>%
               add_header_above(header = HeaderAboveStr) %>%
# kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
  kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
# kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
# landscape()

} else {

  knitr::kable(TableUebersicht, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Grafik - Parameter setzen
if (i_ProfileData2) {
  SubFigCap    <- "Datenübersicht"
  SubFigName   <- "PlotUebers"
  SubName      <- "NPartsUebers"
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
```{r PlotUebersicht, child=if(i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

`r if (i_ProfileData2) {
paste("Folgende Attribute sind im ersten Datensatz vorhanden aber nicht im zweiten:",
paste(paste0(Attr1_not_2, " (", Class1_not_2, ")"), collapse = ", "), "\n")
}`

`r if (i_ProfileData2) {
paste("Folgende Attribute sind im zweiten Datensatz vorhanden aber nicht im ersten:",
paste(paste0(Attr2_not_1, " (", Class2_not_1, ")"), collapse = ", "))
}`

# Text - Attribute
```{r PlotCharPrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle erstellen ................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_DataChar > 0) {
  if (i_ProfileData2) {

    # Zwei Datensätze
    TableChar <- ProfileChar
    TableChar[, 2] <- format(TableChar[, 2], big.mark = "'")
    TableChar[, 3] <- format(TableChar[, 3], big.mark = "'")
    TableChar[, 5] <- format(TableChar[, 5], big.mark = "'")
    TableChar[, 6] <- format(TableChar[, 6], big.mark = "'")
    TableChar[, 4] <- ifelse(TableChar[, 4] == TRUE, "Ja", "Nein")
    TableChar[, 7] <- ifelse(TableChar[, 7] == TRUE, "Ja", "Nein")
    TableChar      <- substituteNA(TableChar, substChar = "-")

    names(TableChar) <- c("Kennzahl", "a)\nAnzahl\nverschieden", "a)\nAnzahl\nNA", "a)\nist\nZahl",
                          "b)\nAnzahl\nverschieden", "b)\nAnzahl\nNA", "b)\nist\nZahl")
    ColNamesTable    <- gsub("a)\n", "", names(TableChar))
    ColNamesTable    <- gsub("b)\n", "", ColNamesTable)
    HeaderAboveStr   <- c("", "Datei a)" = 3, "Datei b)" = 3)

  } else {

    # Ein Datensatz
    TableChar <- ProfileChar
    TableChar[, 2] <- format(TableChar[, 2], big.mark = "'")
    TableChar[, 3] <- format(TableChar[, 3], big.mark = "'")
    TableChar[, 4] <- ifelse(TableChar[, 4] == TRUE, "Ja", "Nein")
    TableChar      <- substituteNA(TableChar, substChar = "-")

    names(TableChar) <- c("Kennzahl", "Anzahl\nverschieden", "Anzahl\nNA", "ist\nZahl")
    ColNamesTable    <- names(TableChar)
    HeaderAboveStr   <- NULL
  }
}
#
# *Not run*  head(ProfileChar)                                                                    ..{{{
#                name distinct.x countNA.x likeNumber.x distinct.y countNA.y likeNumber.y
# 1:      familien.nr       9967         0        FALSE       2879         0         TRUE
# 2: familienstellung          3         0        FALSE          3         0        FALSE
# 3:       geschlecht          2         0        FALSE          2         0        FALSE
# 4:       partner.nr      10000         0        FALSE       2895         0         TRUE
# 5:          sprache          4         0        FALSE          4         0        FALSE
#}}}
# *Not run*  head(TableChar)                                                                      ..{{{
#            Kennzahl a)\nAnzahl\nverschieden a)\nAnzahl\nNA a)\nist\nZahl b)\nAnzahl\nverschieden b)\nAnzahl\nNA
# 1:      familien.nr                  9'967             0         Nein                  2'879             0
# 2: familienstellung                      3             0         Nein                      3             0
# 3:       geschlecht                      2             0         Nein                      2             0
# 4:       partner.nr                 10'000             0         Nein                  2'895             0
# 5:          sprache                      4             0         Nein                      4             0
#    b)\nist\nZahl
# 1:           Ja
# 2:         Nein
# 3:         Nein
# 4:           Ja
# 5:         Nein
#}}}
# *Not run*  ColNamesTable                                                                        ..{{{
# [1] "Kennzahl"            "Anzahl\nverschieden" "Anzahl\nNA"          "ist\nZahl"           "Anzahl\nverschieden"
# [6] "Anzahl\nNA"          "ist\nZahl"
# HeaderAboveStr
#          Datei a) Datei b)
#       ""      "3"      "3"
#> }}}
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_DataChar > 0) {
  cap <- "Textattribute"
  if (OutputFormat == "pdf") {

    knitr::kable(TableChar, caption=cap,
                 row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrrr",
                 format="latex", linesep=c(rep("", nrow(TableChar)), "\\addlinespace"),
                 escape = FALSE, col.names = linebreak(ColNamesTable, align = "c")) %>%
    add_header_above(header = HeaderAboveStr) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableCharX <- TableChar
    colnames(TableCharX) <- gsub("\n", " ", colnames(TableCharX))
    knitr::kable(TableCharX, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrrr")

  }
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Textattribute"
  SubFigName <- "PlotChar"
  SubName    <- "NPartsChar"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataChar == 0) {"Es sind keine Text - Attribute vorhanden"}`
```{r PlotChar, child=if(i_DataChar > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

# Numerische Attribute
```{r PlotNumPrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle erstellen ................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_DataNum > 0) {
  if (i_ProfileData2) {

    # Zwei Datensätze
    TableNum <- ProfileNum
    TableNum[,  2] <- format(TableNum[, 2], big.mark = "'")
    TableNum[,  3] <- format(TableNum[, 3], big.mark = "'")
    TableNum[,  4] <- format(TableNum[, 4], big.mark = "'")
    TableNum[,  5] <- format(round(TableNum[,  5], 2), big.mark = "'")
    TableNum[,  6] <- format(round(TableNum[,  6], 2), big.mark = "'")
    TableNum[,  7] <- format(round(TableNum[,  7], 3), big.mark = "'")
    TableNum[,  8] <- format(round(TableNum[,  8], 3), big.mark = "'")
    TableNum[,  9] <- format(round(TableNum[,  9], 2), big.mark = "'")
    TableNum[, 10] <- format(round(TableNum[, 10], 2), big.mark = "'")

    TableNum[, 11] <- format(TableNum[, 11], big.mark = "'")
    TableNum[, 12] <- format(TableNum[, 12], big.mark = "'")
    TableNum[, 13] <- format(TableNum[, 13], big.mark = "'")
    TableNum[, 14] <- format(round(TableNum[, 14], 2), big.mark = "'")
    TableNum[, 15] <- format(round(TableNum[, 15], 2), big.mark = "'")
    TableNum[, 16] <- format(round(TableNum[, 16], 3), big.mark = "'")
    TableNum[, 17] <- format(round(TableNum[, 17], 3), big.mark = "'")
    TableNum[, 18] <- format(round(TableNum[, 18], 2), big.mark = "'")
    TableNum[, 19] <- format(round(TableNum[, 19], 2), big.mark = "'")
    TableNum       <- substituteNA(TableNum, substChar = "-")

    names(TableNum)  <- c("Kennzahl", "a)\nAnzahl\nverschieden", "a)\nAnzahl\nNA", "a)\nAnzahl\n0", "a)\nMinimum",
                          "a)\nMaximum", "a)\nDurch-\nschnitt", "a)\nMedian", "a)\nQ25\\%", "a)\nQ75\\%",
                          "b)\nAnzahl\nverschieden", "b)\nAnzahl\nNA", "b)\nAnzahl\n0", "b)\nMinimum",
                          "b)\nMaximum", "b)\nDurch-\nschnitt", "b)\nMedian", "b)\nQ25\\%", "b)\nQ75\\%")

    TableNum_1       <- TableNum[, c(1, 2, 3, 4, 11, 12, 13)]
    TableNum_2       <- TableNum[, c(1, 5, 6, 7, 14, 15, 16)]
    ColNamesTable_1  <- gsub("a)\n", "", names(TableNum_1))
    ColNamesTable_1  <- gsub("b)\n", "", ColNamesTable_1)
    ColNamesTable_2  <- gsub("a)\n", "", names(TableNum_2))
    ColNamesTable_2  <- gsub("b)\n", "", ColNamesTable_2)
    HeaderAboveStr_1 <- c("", "Datei a)" = 3, "Datei b)" = 3)
    HeaderAboveStr_2 <- c("", "Datei a)" = 3, "Datei b)" = 3)

  } else {

    # Ein Datensatz
    TableNum <- ProfileNum
    TableNum[,  2] <- format(TableNum[, 2], big.mark = "'")
    TableNum[,  3] <- format(TableNum[, 3], big.mark = "'")
    TableNum[,  4] <- format(TableNum[, 4], big.mark = "'")
    TableNum[,  5] <- format(round(TableNum[,  5], 2), big.mark = "'")
    TableNum[,  6] <- format(round(TableNum[,  6], 2), big.mark = "'")
    TableNum[,  7] <- format(round(TableNum[,  7], 3), big.mark = "'")
    TableNum[,  8] <- format(round(TableNum[,  8], 3), big.mark = "'")
    TableNum[,  9] <- format(round(TableNum[,  9], 2), big.mark = "'")
    TableNum[, 10] <- format(round(TableNum[, 10], 2), big.mark = "'")
    TableNum       <- substituteNA(TableNum, substChar = "-")

    names(TableNum)  <- c("Kennzahl", "Anzahl\nverschieden", "Anzahl\nNA", "Anzahl\n0", "Minimum",
                          "Maximum", "Durch-\nschnitt", "Median\nQ50\\%", "Q25\\%", "Q75\\%")

    TableNum_1       <- TableNum[, c(1, 2, 3, 4)]
    TableNum_2       <- TableNum[, c(1, 5, 6, 7, 8, 9, 10)]
    ColNamesTable_1  <- gsub("a)\n", "", names(TableNum_1))
    ColNamesTable_1  <- gsub("b)\n", "", ColNamesTable_1)
    ColNamesTable_2  <- gsub("a)\n", "", names(TableNum_2))
    ColNamesTable_2  <- gsub("b)\n", "", ColNamesTable_2)
    HeaderAboveStr_1 <- NULL
    HeaderAboveStr_2 <- NULL

  }
}
#
# *Not run*  head(ProfileNum)                                                                     ..{{{
#                           name distinct.x countNA.x countZero.x     min.x   max.x       mean.x median.x     q25.x
# 1: Anzahl.Kontakte.Mitarbeiter          8         0        9850       0.0    7.00     0.032600    0.000     0.000
# 2:                       alter         NA        NA          NA        NA      NA           NA       NA        NA
# 3:            anz.Empfehlungen          7         0        9979       0.0    9.00     0.004200    0.000     0.000
# 4:                  cummeanBEL        505      1796         661      -0.2  120.00     9.785974    6.000     2.250
# 5:                  cummeanKON        569      1796        1016       0.0  226.40    10.730140    5.600     1.600
# 6:                  cummeanLEI       6737      1796        1236 -161896.3 1265.34 -3164.238408 -834.445 -2794.827
#       q75.x distinct.y countNA.y countZero.y     min.y    max.y        mean.y median.y q25.y q75.y
# 1:    0.000          8         0        2879      0.00   9.0000   0.016234888        0     0     0
# 2:       NA         94         0           0     17.00 111.0000  62.068739206       64    46    78
# 3:    0.000          3         0        2893      0.00   6.0000   0.002417962        0     0     0
# 4:   13.000         48         0        2834      0.00  38.2000   0.149001563        0     0     0
# 5:   13.800         45         0        2840      0.00 127.6667   0.200463443        0     0     0
# 6: -153.485         47         0        2849 -23043.74  16.0000 -31.650732222        0     0     0
# }}}
# *Not run*  head(TableNum)                                                                       ..{{{
#                       Kennzahl a)\nAnzahl\nverschieden a)\nAnzahl\nNA a)\nAnzahl\n0  a)\nMinimum a)\nMaximum
# 1: Anzahl.Kontakte.Mitarbeiter                      8             0        9'850        0.00       7.00
# 2:                       alter                     NA            NA           NA          NA         NA
# 3:            anz.Empfehlungen                      7             0        9'979        0.00       9.00
# 4:                  cummeanBEL                    505         1'796          661       -0.20     120.00
# 5:                  cummeanKON                    569         1'796        1'016        0.00     226.40
# 6:                  cummeanLEI                  6'737         1'796        1'236 -161'896.33   1'265.34
#    a)\nDurch-\nschnitt a)\nMedian   a)\nQ25%  a)\nQ75% b)\nAnzahl\nverschieden b)\nAnzahl\nNA b)\nAnzahl\n0 b)\nMinimum
# 1:              0.033     0.000      0.00     0.00                      8             0        2'879       0.00
# 2:                 NA        NA        NA       NA                     94             0            0      17.00
# 3:              0.004     0.000      0.00     0.00                      3             0        2'893       0.00
# 4:              9.786     6.000      2.25    13.00                     48             0        2'834       0.00
# 5:             10.730     5.600      1.60    13.80                     45             0        2'840       0.00
# 6:         -3'164.238  -834.445 -2'794.83  -153.49                     47             0        2'849 -23'043.74
#    b)\nMaximum b)\nDurch-\nschnitt b)\nMedian b)\nQ25% b)\nQ75%
# 1:       9.00              0.016         0       0       0
# 2:     111.00             62.069        64      46      78
# 3:       6.00              0.002         0       0       0
# 4:      38.20              0.149         0       0       0
# 5:     127.67              0.200         0       0       0
# 6:      16.00            -31.651         0       0       0
#> }}}
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 1 ................................................
if (i_DataNum > 0) {
  cap <- "Numerische Attribute"
  if (OutputFormat == "pdf") {

    knitr::kable(TableNum_1, caption=cap,
                 row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
                 format="latex", linesep=c(rep("", nrow(TableNum_1)), "\\addlinespace"),
                 escape = FALSE, col.names = linebreak(ColNamesTable_1, align = "c")) %>%
    add_header_above(header = HeaderAboveStr_1) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableNum_1X <- TableNum_1
    colnames(TableNum_1X) <- gsub("\n", " ", colnames(TableNum_1X))
    knitr::kable(TableNum_1X, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
  # rm(TableNum)
  # rm(TableNum_1)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Numerische Attribute"
  SubFigName <- "PlotNum"
  SubName    <- "NPartsNum"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataNum == 0) {"Es sind keine numerischen Attribute vorhanden"}`
```{r PlotNum, child=if(i_DataNum > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

## Wertebereiche Numerische Attribute
```{r PlotWerteBerNumPrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 2 ................................................
if (i_DataNum > 0) {
  cap <- "Wertebereiche Numerische Attribute"
  if (OutputFormat == "pdf") {

    knitr::kable(TableNum_2, caption=cap,
                row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
                format="latex", linesep=c(rep("", nrow(TableNum_2)), "\\addlinespace"),
                escape = FALSE, col.names = linebreak(ColNamesTable_2, align = "c")) %>%
                add_header_above(header = HeaderAboveStr_2) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableNum_2X <- TableNum_2
    colnames(TableNum_2X) <- gsub("\n", " ", colnames(TableNum_2X))
    knitr::kable(TableNum_2X, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
}

# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Wertebereiche Numerische Attribute"
  SubFigName <- "PlotWerteBerNum"
  SubName    <- "NPartsWerteBerNum"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataNum == 0) {"Es sind keine numerischen Attribute vorhanden"}`
```{r PlotWerteBerNum, child=if(i_DataNum > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

# Ganzzahlige Attribute
```{r PlotIntPrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle erstellen ................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_DataInt > 0) {
  if (i_ProfileData2) {

    TableInt <- ProfileInt
    TableInt[,  2] <- format(TableInt[, 2], big.mark = "'")
    TableInt[,  3] <- format(TableInt[, 3], big.mark = "'")
    TableInt[,  4] <- format(TableInt[, 4], big.mark = "'")
    TableInt[,  5] <- format(round(TableInt[,  5], 2), big.mark = "'")
    TableInt[,  6] <- format(round(TableInt[,  6], 2), big.mark = "'")
    TableInt[,  7] <- format(round(TableInt[,  7], 3), big.mark = "'")
    TableInt[,  8] <- format(round(TableInt[,  8], 3), big.mark = "'")
    TableInt[,  9] <- format(round(TableInt[,  9], 2), big.mark = "'")
    TableInt[, 10] <- format(round(TableInt[, 10], 2), big.mark = "'")

    TableInt[, 11] <- format(TableInt[, 11], big.mark = "'")
    TableInt[, 12] <- format(TableInt[, 12], big.mark = "'")
    TableInt[, 13] <- format(TableInt[, 13], big.mark = "'")
    TableInt[, 14] <- format(round(TableInt[, 14], 2), big.mark = "'")
    TableInt[, 15] <- format(round(TableInt[, 15], 2), big.mark = "'")
    TableInt[, 16] <- format(round(TableInt[, 16], 3), big.mark = "'")
    TableInt[, 17] <- format(round(TableInt[, 17], 3), big.mark = "'")
    TableInt[, 18] <- format(round(TableInt[, 18], 2), big.mark = "'")
    TableInt[, 19] <- format(round(TableInt[, 19], 2), big.mark = "'")
    TableInt       <- substituteNA(TableInt, substChar = "-")

    names(TableInt)  <- c("Kennzahl", "a)\nAnzahl\nverschieden", "a)\nAnzahl\nNA", "a)\nAnzahl\n0", "a)\nMinimum",
                          "a)\nMaximum", "a)\nDurch-\nschnitt", "a)\nMedian", "a)\nQ25\\%", "a)\nQ75\\%",
                          "b)\nAnzahl\nverschieden", "b)\nAnzahl\nNA", "b)\nAnzahl\n0", "b)\nMinimum",
                          "b)\nMaximum", "b)\nDurch-\nschnitt", "b)\nMedian", "b)\nQ25\\%", "b)\nQ75\\%")

    TableInt_1       <- TableInt[, c(1, 2, 3, 4, 11, 12, 13)]
    TableInt_2       <- TableInt[, c(1, 5, 6, 7, 14, 15, 16)]
    ColNamesTable_1  <- gsub("a)\n", "", names(TableInt_1))
    ColNamesTable_1  <- gsub("b)\n", "", ColNamesTable_1)
    ColNamesTable_2  <- gsub("a)\n", "", names(TableInt_2))
    ColNamesTable_2  <- gsub("b)\n", "", ColNamesTable_2)
    HeaderAboveStr_1 <- c("", "Datei a)" = 3, "Datei b)" = 3)
    HeaderAboveStr_2 <- c("", "Datei a)" = 3, "Datei b)" = 3)

  } else {

    # Ein Datensatz
    TableInt <- ProfileInt
    TableInt[,  2] <- format(TableInt[, 2], big.mark = "'")
    TableInt[,  3] <- format(TableInt[, 3], big.mark = "'")
    TableInt[,  4] <- format(TableInt[, 4], big.mark = "'")
    TableInt[,  5] <- format(round(TableInt[,  5], 2), big.mark = "'")
    TableInt[,  6] <- format(round(TableInt[,  6], 2), big.mark = "'")
    TableInt[,  7] <- format(round(TableInt[,  7], 3), big.mark = "'")
    TableInt[,  8] <- format(round(TableInt[,  8], 3), big.mark = "'")
    TableInt[,  9] <- format(round(TableInt[,  9], 2), big.mark = "'")
    TableInt[, 10] <- format(round(TableInt[, 10], 2), big.mark = "'")
    TableInt       <- substituteNA(TableInt, substChar = "-")

    names(TableInt) <- c("Kennzahl", "Anzahl\nverschieden", "Anzahl\nNA", "Anzahl\n0", "Minimum",
                         "Maximum", "Durch-\nschnitt", "Median\nQ50\\%", "Q25\\%", "Q75\\%")

    TableInt_1       <- TableInt[, c(1, 2, 3, 4)]
    TableInt_2       <- TableInt[, c(1, 5, 6, 7, 8, 9, 10)]
    ColNamesTable_1  <- names(TableInt_1)
    ColNamesTable_2  <- names(TableInt_2)
    HeaderAboveStr_1 <- NULL
    HeaderAboveStr_2 <- NULL
  }
}
#
# *Not run*  head(ProfileInt)                                                                     ..{{{
#                       name distinct.x countNA.x countZero.x min.x max.x  mean.x median.x q25.x q75.x distinct.y
# 1:                   alter        109         0          21     0   110 42.6264       42    27    58         NA
# 2: anz.familien.mitglieder          2         0           0     1     2  1.0066        1     1     1          2
#    countNA.y countZero.y min.y max.y   mean.y median.y q25.y q75.y
# 1:        NA          NA    NA    NA       NA       NA    NA    NA
# 2:         0           0     1     2 1.011054        1     1     1
#}}}
# *Not run*  head(TableInt)                                                                       ..{{{
#                   Kennzahl a)\nAnzahl\nverschieden a)\nAnzahl\nNA a)\nAnzahl\n0 a)\nMinimum a)\nMaximum
# 1:                   alter                    109             0           21          0        110
# 2: anz.familien.mitglieder                      2             0            0          1          2
#    a)\nDurch-\nschnitt a)\nMedian a)\nQ25% a)\nQ75% b)\nAnzahl\nverschieden b)\nAnzahl\nNA b)\nAnzahl\n0 b)\nMinimum
# 1:             42.626        42      27      58                     NA            NA           NA         NA
# 2:              1.007         1       1       1                      2             0            0          1
#    b)\nMaximum b)\nDurch-\nschnitt b)\nMedian b)\nQ25% b)\nQ75%
# 1:         NA                 NA        NA      NA      NA
# 2:          2              1.011         1       1       1
#}}}
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 1 ................................................
if (i_DataInt > 0) {
  cap <- "Ganzzahlige Attribute"
  if (OutputFormat == "pdf") {

    knitr::kable(TableInt_1, caption=cap,
                 row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
                 format="latex", linesep=c(rep("", nrow(TableInt_1)), "\\addlinespace"),
                 escape = FALSE, col.names = linebreak(ColNamesTable_1, align = "c")) %>%
    add_header_above(header = HeaderAboveStr_1) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableInt_1X <- TableInt_1
    colnames(TableInt_1X) <- gsub("\n", " ", colnames(TableInt_1X))
    knitr::kable(TableInt_1X, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Ganzzahlige Attribute"
  SubFigName <- "PlotInt"
  SubName    <- "NPartsInt"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataInt == 0) {"Es sind keine ganzzahligen Attribute vorhanden"}`
```{r PlotInt, child=if(i_DataInt > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

## Wertebereiche ganzzahliger Attribute
```{r PlotWerteBerIntPrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 2 ................................................
if (i_DataInt > 0) {
  cap <- "Wertebereiche Ganzzahlige Attribute"
  if (OutputFormat == "pdf") {

    knitr::kable(TableInt_2, caption=cap,
                row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
                format="latex", linesep=c(rep("", nrow(TableInt_2)), "\\addlinespace"),
                escape = FALSE, col.names = linebreak(ColNamesTable_2, align = "c")) %>%
                add_header_above(header = HeaderAboveStr_2) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableInt_2X <- TableInt_2
    colnames(TableInt_2X) <- gsub("\n", " ", colnames(TableInt_2X))
    knitr::kable(TableInt_2X, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
  # rm(TableInt_2) # ??
}

# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Wertebereiche Interische Attribute"
  SubFigName <- "PlotWerteBerInt"
  SubName    <- "NPartsWerteBerInt"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataInt == 0) {"Es sind keine ganzzahligen Attribute vorhanden"}`
```{r PlotWerteBerInt, child=if(i_DataInt > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

# Text-Attribute mit numerischem Inhalt
```{r PlotCharLikeNumPrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle erstellen ................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_DataCharLikeNum > 0) {
  if (i_ProfileData2) {

    TableCharLikeNum <- ProfileCharLikeNum
    TableCharLikeNum[,  2] <- format(TableCharLikeNum[, 2], big.mark = "'")
    TableCharLikeNum[,  3] <- format(TableCharLikeNum[, 3], big.mark = "'")
    TableCharLikeNum[,  4] <- format(TableCharLikeNum[, 4], big.mark = "'")
    TableCharLikeNum[,  5] <- format(round(TableCharLikeNum[,  5], 2), big.mark = "'")
    TableCharLikeNum[,  6] <- format(round(TableCharLikeNum[,  6], 2), big.mark = "'")
    TableCharLikeNum[,  7] <- format(round(TableCharLikeNum[,  7], 3), big.mark = "'")
    TableCharLikeNum[,  8] <- format(round(TableCharLikeNum[,  8], 3), big.mark = "'")
    TableCharLikeNum[,  9] <- format(round(TableCharLikeNum[,  9], 2), big.mark = "'")
    TableCharLikeNum[, 10] <- format(round(TableCharLikeNum[, 10], 2), big.mark = "'")

    TableCharLikeNum[, 11] <- format(TableCharLikeNum[, 11], big.mark = "'")
    TableCharLikeNum[, 12] <- format(TableCharLikeNum[, 12], big.mark = "'")
    TableCharLikeNum[, 13] <- format(TableCharLikeNum[, 13], big.mark = "'")
    TableCharLikeNum[, 14] <- format(round(TableCharLikeNum[, 14], 2), big.mark = "'")
    TableCharLikeNum[, 15] <- format(round(TableCharLikeNum[, 15], 2), big.mark = "'")
    TableCharLikeNum[, 16] <- format(round(TableCharLikeNum[, 16], 3), big.mark = "'")
    TableCharLikeNum[, 17] <- format(round(TableCharLikeNum[, 17], 3), big.mark = "'")
    TableCharLikeNum[, 18] <- format(round(TableCharLikeNum[, 18], 2), big.mark = "'")
    TableCharLikeNum[, 19] <- format(round(TableCharLikeNum[, 19], 2), big.mark = "'")
    TableCharLikeNum       <- substituteNA(TableCharLikeNum, substChar = "-")

    names(TableCharLikeNum) <- c("Kennzahl", "a)\nAnzahl\nverschieden", "a)\nAnzahl\nNA", "a)\nAnzahl\n0", "a)\nMinimum",
                                 "a)\nMaximum", "a)\nDurch-\nschnitt", "a)\nMedian", "a)\nQ25\\%", "a)\nQ75\\%",
                                 "b)\nAnzahl\nverschieden", "b)\nAnzahl\nNA", "b)\nAnzahl\n0", "b)\nMinimum",
                                 "b)\nMaximum", "b)\nDurch-\nschnitt", "b)\nMedian", "b)\nQ25\\%", "b)\nQ75\\%")

    TableCharLikeNum_1 <- TableCharLikeNum[, c(1, 2, 3, 4, 11, 12, 13)]
    TableCharLikeNum_2 <- TableCharLikeNum[, c(1, 5, 6, 7, 14, 15, 16)]
    ColNamesTable_1    <- gsub("a)\n", "", names(TableCharLikeNum_1))
    ColNamesTable_1    <- gsub("b)\n", "", ColNamesTable_1)
    ColNamesTable_2    <- gsub("a)\n", "", names(TableCharLikeNum_2))
    ColNamesTable_2    <- gsub("b)\n", "", ColNamesTable_2)
    HeaderAboveStr_1   <- c("", "Datei a)" = 3, "Datei b)" = 3)
    HeaderAboveStr_2   <- c("", "Datei a)" = 3, "Datei b)" = 3)

  } else {

    # Ein Datensatz
    TableCharLikeNum <- ProfileCharLikeNum
    TableCharLikeNum[,  2] <- format(TableCharLikeNum[, 2], big.mark = "'")
    TableCharLikeNum[,  3] <- format(TableCharLikeNum[, 3], big.mark = "'")
    TableCharLikeNum[,  4] <- format(TableCharLikeNum[, 4], big.mark = "'")
    TableCharLikeNum[,  5] <- format(round(TableCharLikeNum[,  5], 2), big.mark = "'")
    TableCharLikeNum[,  6] <- format(round(TableCharLikeNum[,  6], 2), big.mark = "'")
    TableCharLikeNum[,  7] <- format(round(TableCharLikeNum[,  7], 3), big.mark = "'")
    TableCharLikeNum[,  8] <- format(round(TableCharLikeNum[,  8], 3), big.mark = "'")
    TableCharLikeNum[,  9] <- format(round(TableCharLikeNum[,  9], 2), big.mark = "'")
    TableCharLikeNum[, 10] <- format(round(TableCharLikeNum[, 10], 2), big.mark = "'")
    TableCharLikeNum       <- substituteNA(TableCharLikeNum, substChar = "-")

    names(TableCharLikeNum) <- c("Kennzahl", "Anzahl\nverschieden", "Anzahl\nNA", "Anzahl\n0", "Minimum",
                                 "Maximum", "Durch-\nschnitt", "Median\nQ50\\%", "Q25\\%", "Q75\\%")

    TableCharLikeNum_1 <- TableCharLikeNum[, c(1, 2, 3, 4)]
    TableCharLikeNum_2 <- TableCharLikeNum[, c(1, 5, 6, 7, 8, 9, 10)]
    ColNamesTable_1    <- names(TableCharLikeNum_1)
    ColNamesTable_2    <- names(TableCharLikeNum_2)
    HeaderAboveStr_1   <- NULL
    HeaderAboveStr_2   <- NULL
  }
}
#
# *Not run*  head(ProfileCharLikeNum)                                                             ..{{{
#           name distinct.x countNA.x countZero.x min.x max.x mean.x median.x q25.x q75.x distinct.y countNA.y
# 1: familien.nr         NA        NA          NA    NA    NA     NA       NA    NA    NA       2879         0
# 2:  partner.nr         NA        NA          NA    NA    NA     NA       NA    NA    NA       2895         0
#    countZero.y min.y   max.y  mean.y median.y   q25.y   q75.y
# 1:           0 51342 2805035 1332923  1173271 1081689 1392375
# 2:           0 51342 2874432 2241976  2210967 2102736 2357496
#}}}
# *Not run*  head(TableCharLikeNum)                                                               ..{{{
#       Kennzahl a)\nAnzahl\nverschieden a)\nAnzahl\nNA a)\nAnzahl\n0 a)\nMinimum a)\nMaximum a)\nDurch-\nschnitt
# 1: familien.nr                     NA            NA           NA         NA         NA                 NA
# 2:  partner.nr                     NA            NA           NA         NA         NA                 NA
#    a)\nMedian a)\nQ25% a)\nQ75% b)\nAnzahl\nverschieden b)\nAnzahl\nNA b)\nAnzahl\n0 b)\nMinimum b)\nMaximum
# 1:        NA      NA      NA                  2'879             0            0     51'342  2'805'035
# 2:        NA      NA      NA                  2'895             0            0     51'342  2'874'432
#    b)\nDurch-\nschnitt b)\nMedian   b)\nQ25%   b)\nQ75%
# 1:          1'332'923 1'173'271 1'081'689 1'392'375
# 2:          2'241'976 2'210'967 2'102'736 2'357'496
#}}}
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 1 ................................................
if (i_DataCharLikeNum > 0) {
  cap <- "Textattribute mit numerischem Inhalt"
  if (OutputFormat == "pdf") {

    knitr::kable(TableCharLikeNum_1, caption=cap,
                 row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
                 format="latex", linesep=c(rep("", nrow(TableCharLikeNum_1)), "\\addlinespace"),
                 escape = FALSE, col.names = linebreak(ColNamesTable_1, align = "c")) %>%
    add_header_above(header = HeaderAboveStr_1) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableCharLikeNum_1X <- TableCharLikeNum_1
    colnames(TableCharLikeNum_1X) <- gsub("\n", " ", colnames(TableCharLikeNum_1X))
    knitr::kable(TableCharLikeNum_1X, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
  # rm(TableCharLikeNum)
  # rm(TableCharLikeNum_1)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Ganzzahlige Attribute"
  SubFigName <- "PlotCharLikeNum"
  SubName    <- "NPartsCharLikeNum"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataCharLikeNum == 0) {"Es sind keine Text-Attribute mit numerischem Inhalt vorhanden"}`
```{r PlotCharLikeNum, child=if(i_DataCharLikeNum > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

## Wertebereiche Text-Attribute mit numerischem Inhalt
```{r PlotWerteBerCharLikeNumPrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 2 ................................................
if (i_DataCharLikeNum > 0) {
  cap <- "Wertebereiche Textattribute mit numerischem Inhalt"
  if (OutputFormat == "pdf") {

    knitr::kable(TableCharLikeNum_2, caption=cap,
                 row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
                 format="latex", linesep=c(rep("", nrow(TableCharLikeNum_2)), "\\addlinespace"),
                 escape = FALSE, col.names = linebreak(ColNamesTable_2, align = "c")) %>%
                 add_header_above(header = HeaderAboveStr_2) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableCharLikeNum_2X <- TableCharLikeNum_2
    colnames(TableCharLikeNum_2X) <- gsub("\n", " ", colnames(TableCharLikeNum_2X))
    knitr::kable(TableCharLikeNum_2X, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
  # rm(TableCharLikeNum_2) # ??
}

# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Ganzzahlige Attribute"
  SubFigName <- "PlotWerteBerCharLikeNum"
  SubName    <- "NPartsWerteBerCharLikeNum"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataCharLikeNum == 0) {"Es sind keine Text-Attribute mit numerischem Inhalt vorhanden"}`
```{r PlotWerteBerCharLikeNum, child=if(i_DataCharLikeNum > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

# Faktor-Attribute
```{r PlotFactorPrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle erstellen ................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_DataFactor > 0) {
  if (i_ProfileData2) {

    TableFactor <- ProfileFactor[, c(1, 3, 4, 2, 6, 7, 5)]
    TableFactor[,  2] <- format(TableFactor[, 2], big.mark = "'")
    TableFactor[,  3] <- format(TableFactor[, 3], big.mark = "'")
    TableFactor[,  4] <- format(TableFactor[, 4], big.mark = "'")
    TableFactor[,  5] <- format(TableFactor[, 5], big.mark = "'")
    TableFactor[,  6] <- format(TableFactor[, 6], big.mark = "'")
    TableFactor[,  7] <- format(TableFactor[, 7], big.mark = "'")
    TableFactor       <- substituteNA(TableFactor, substChar = "-")

    names(TableFactor) <- c("Kennzahl", "a)\nAnzahl\nverschieden", "a)\nAnzahl\nStufen", "a)\nAnzahl\nNA",
                            "b)\nAnzahl\nverschieden", "b)\nAnzahl\nStufen", "b)\nAnzahl\nNA")
    ColNamesTable      <- gsub("a)\n", "", names(TableFactor))
    ColNamesTable      <- gsub("b)\n", "", ColNamesTable)
    HeaderAboveStr     <- c("", "Datei a)" = 3, "Datei b)" = 3)

  } else {

    # Ein Datensatz
    TableFactor <- ProfileFactor[, c(1, 3, 4, 2)]
    TableFactor[,  2] <- format(TableFactor[, 2], big.mark = "'")
    TableFactor[,  3] <- format(TableFactor[, 3], big.mark = "'")
    TableFactor[,  4] <- format(TableFactor[, 4], big.mark = "'")
    TableFactor       <- substituteNA(TableFactor, substChar = "-")

    names(TableFactor) <- c("Kennzahl", "Anzahl\nverschieden", "Anzahl\nStufen", "Anzahl\nNA")
    ColNamesTable      <- names(TableFactor)
    HeaderAboveStr     <- NULL

  }
}
#
# *Not run*  head(ProfileFactor)                                                                  ..{{{
#                                          name countNA.x distinct.x levels.x countNA.y distinct.y levels.y
# 1:         Datum.Erreicht.in.19.26.Jaehrige.I         0          2        2         0          2        2
# 2:           Datum.Erreicht.in.DENTA.Aktion.I         0          2        2         0          1        1
# 3: Datum.Erreicht.in.Nachfassung.Kuendigung.I         0          2        2         0          2        2
# 4:      Datum.Erreicht.in.Upselling.HOSPITA.I         0          2        2         0          2        2
# 5:        Datum.Selektion.in.19.26.Jaehrige.I         0          2        2         0          2        2
# 6:          Datum.Selektion.in.DENTA.Aktion.I         0          2        2         0          1        1
#}}}
# *Not run*  head(TableFactor)                                                                    ..{{{
#                                      Kennzahl a)\nAnzahl\nverschieden a)\nAnzahl\nStufen a)\nAnzahl\nNA
# 1:         Datum.Erreicht.in.19.26.Jaehrige.I                      2                 2             0
# 2:           Datum.Erreicht.in.DENTA.Aktion.I                      2                 2             0
# 3: Datum.Erreicht.in.Nachfassung.Kuendigung.I                      2                 2             0
# 4:      Datum.Erreicht.in.Upselling.HOSPITA.I                      2                 2             0
# 5:        Datum.Selektion.in.19.26.Jaehrige.I                      2                 2             0
# 6:          Datum.Selektion.in.DENTA.Aktion.I                      2                 2             0
#    b)\nAnzahl\nverschieden b)\nAnzahl\nStufen b)\nAnzahl\nNA
# 1:                      2                 2             0
# 2:                      1                 1             0
# 3:                      2                 2             0
# 4:                      2                 2             0
# 5:                      2                 2             0
# 6:                      1                 1             0
#}}}
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 1 ................................................
if (i_DataFactor > 0) {
  cap <- "Faktor - Attribute"
  if (OutputFormat == "pdf") {

    knitr::kable(TableFactor, caption=cap,
                 row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="r",
                 format="latex", linesep=c(rep("", nrow(TableFactor)), "\\addlinespace"),
                 escape = FALSE, col.names = linebreak(ColNamesTable, align = "c")) %>%
    add_header_above(header = HeaderAboveStr) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableFactorX <- TableFactor
    colnames(TableFactorX) <- gsub("\n", " ", colnames(TableFactorX))
    knitr::kable(TableFactorX, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
  # rm(TableFactor)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Faktor - Attribute"
  SubFigName <- "PlotFactor"
  SubName    <- "NPartsFactor"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataFactor == 0) {"Es sind keine Faktor-Attribute vorhanden"}`
```{r PlotFactor, child=if(i_DataFactor > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

# Datum-Attribute
```{r PlotDatePrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle erstellen ................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
if (i_DataDate > 0) {
  if (i_ProfileData2) {

    TableDate <- ProfileDate
    TableDate[,  2] <- format(TableDate[, 2], big.mark = "'")
    TableDate[,  3] <- format(TableDate[, 3], big.mark = "'")
    TableDate[,  4] <- format(TableDate[, 4], big.mark = "'")
    # TableDate[,  5] <- format(round(TableDate[,  5], 2), big.mark = "'")
    # TableDate[,  6] <- format(round(TableDate[,  6], 2), big.mark = "'")
    # TableDate[,  7] <- format(round(TableDate[,  7], 3), big.mark = "'")
    # TableDate[,  8] <- format(round(TableDate[,  8], 3), big.mark = "'")
    # TableDate[,  9] <- format(round(TableDate[,  9], 2), big.mark = "'")
    # TableDate[, 10] <- format(round(TableDate[, 10], 2), big.mark = "'")

    TableDate[, 11] <- format(TableDate[, 11], big.mark = "'")
    TableDate[, 12] <- format(TableDate[, 12], big.mark = "'")
    TableDate[, 13] <- format(TableDate[, 13], big.mark = "'")
    # TableDate[, 14] <- format(round(TableDate[, 14], 2), big.mark = "'")
    # TableDate[, 15] <- format(round(TableDate[, 15], 2), big.mark = "'")
    # TableDate[, 16] <- format(round(TableDate[, 16], 3), big.mark = "'")
    # TableDate[, 17] <- format(round(TableDate[, 17], 3), big.mark = "'")
    # TableDate[, 18] <- format(round(TableDate[, 18], 2), big.mark = "'")
    # TableDate[, 19] <- format(round(TableDate[, 19], 2), big.mark = "'")
    TableDate       <- substituteNA(TableDate, substChar = "-")

    names(TableDate) <- c("Kennzahl", "a)\nAnzahl\nverschieden", "a)\nAnzahl\nNA", "a)\nAnzahl\n0", "a)\nMinimum",
                          "a)\nMaximum", "a)\nDurch-\nschnitt", "a)\nMedian", "a)\nQ25\\%", "a)\nQ75\\%",
                          "b)\nAnzahl\nverschieden", "b)\nAnzahl\nNA", "b)\nAnzahl\n0", "b)\nMinimum",
                          "b)\nMaximum", "b)\nDurch-\nschnitt", "b)\nMedian", "b)\nQ25\\%", "b)\nQ75\\%")

    TableDate_1      <- TableDate[, c(1, 2, 3, 4, 11, 12, 13)]
    TableDate_2      <- TableDate[, c(1, 5, 6, 7, 14, 15, 16)]
    ColNamesTable_1  <- gsub("a)\n", "", names(TableDate_1))
    ColNamesTable_1  <- gsub("b)\n", "", ColNamesTable_1)
    ColNamesTable_2  <- gsub("a)\n", "", names(TableDate_2))
    ColNamesTable_2  <- gsub("b)\n", "", ColNamesTable_2)
    HeaderAboveStr_1 <- c("", "Datei a)" = 3, "Datei b)" = 3)
    HeaderAboveStr_2 <- c("", "Datei a)" = 3, "Datei b)" = 3)

  } else {

    # Ein Datensatz
    TableDate <- ProfileDate
    TableDate[,  2] <- format(TableDate[, 2], big.mark = "'")
    TableDate[,  3] <- format(TableDate[, 3], big.mark = "'")
    TableDate[,  4] <- format(TableDate[, 4], big.mark = "'")
    # TableDate[,  5] <- format(round(TableDate[,  5], 2), big.mark = "'")
    # TableDate[,  6] <- format(round(TableDate[,  6], 2), big.mark = "'")
    # TableDate[,  7] <- format(round(TableDate[,  7], 3), big.mark = "'")
    # TableDate[,  8] <- format(round(TableDate[,  8], 3), big.mark = "'")
    # TableDate[,  9] <- format(round(TableDate[,  9], 2), big.mark = "'")
    # TableDate[, 10] <- format(round(TableDate[, 10], 2), big.mark = "'")
    TableDate       <- substituteNA(TableDate, substChar = "-")

    names(TableDate) <- c("Kennzahl", "Anzahl\nverschieden", "Anzahl\nNA", "Anzahl\n0", "Minimum",
                          "Maximum", "Durchschnitt", "Median\nQ50\\%", "Q25\\%", "Q75\\%")

    TableDate_1      <- TableDate[, c(1, 2, 3, 4)]
    TableDate_2      <- TableDate[, c(1, 5, 6, 7, 8, 9, 10)]
    ColNamesTable_1  <- names(TableDate_1)
    ColNamesTable_2  <- names(TableDate_2)
    HeaderAboveStr_1 <- NULL
    HeaderAboveStr_2 <- NULL
  }
}
#
# *Not run*  head(ProfileDate)                                                                    ..{{{
#                            name distinct.x countNA.x countZero.x      min.x      max.x     mean.x   median.x
# 1:                geburts.datum       8424         0           1 1910-09-25 2020-04-30 1977-11-13 1978-12-15
# 2:       kassen.eintritt.filled       2344         0           5 1930-01-01 2022-01-01 2003-12-05 2009-01-01
# 3: kasseneintitt.abschlussalter         96      1895          28 1940-01-01 2038-01-01 2006-02-03 2009-01-01
# 4:              max.produkt.end        709         0           0 2010-01-04 3000-01-01 2707-10-29 3000-01-01
#         q25.x      q75.x distinct.y countNA.y countZero.y      min.y      max.y     mean.y   median.y      q25.y
# 1: 1962-09-10 1993-07-16       2767         0           0 1908-02-04 2002-07-11 1957-04-10 1954-12-05 1941-06-26
# 2: 1998-01-01 2015-06-23        800         0           7 1927-02-01 2019-01-01 1979-07-20 1983-04-01 1965-07-01
# 3: 1995-01-01 2020-01-01         86       535          42 1938-01-01 2025-01-01 1986-04-02 1985-01-01 1972-01-01
# 4: 2018-12-31 3000-01-01        469         0           0 2004-01-31 3000-01-01 2648-01-23 3000-01-01 2015-12-31
#         q75.y
# 1: 1973-01-20
# 2: 1994-07-01
# 3: 2002-01-01
# 4: 3000-01-01
#}}}
# *Not run*  head(TableDate)                                                                      ..{{{
#                        Kennzahl a)\nAnzahl\nverschieden a)\nAnzahl\nNA a)\nAnzahl\n0 a)\nMinimum a)\nMaximum
# 1:                geburts.datum                  8'424             0            1 1910-09-25 2020-04-30
# 2:       kassen.eintritt.filled                  2'344             0            5 1930-01-01 2022-01-01
# 3: kasseneintitt.abschlussalter                     96         1'895           28 1940-01-01 2038-01-01
# 4:              max.produkt.end                    709             0            0 2010-01-04 3000-01-01
#    a)\nDurch-\nschnitt  a)\nMedian    a)\nQ25%    a)\nQ75% b)\nAnzahl\nverschieden b)\nAnzahl\nNA b)\nAnzahl\n0
# 1:         1977-11-13 1978-12-15 1962-09-10 1993-07-16                  2'767             0            0
# 2:         2003-12-05 2009-01-01 1998-01-01 2015-06-23                    800             0            7
# 3:         2006-02-03 2009-01-01 1995-01-01 2020-01-01                     86           535           42
# 4:         2707-10-29 3000-01-01 2018-12-31 3000-01-01                    469             0            0
#    b)\nMinimum b)\nMaximum b)\nDurch-\nschnitt  b)\nMedian    b)\nQ25%    b)\nQ75%
# 1: 1908-02-04 2002-07-11         1957-04-10 1954-12-05 1941-06-26 1973-01-20
# 2: 1927-02-01 2019-01-01         1979-07-20 1983-04-01 1965-07-01 1994-07-01
# 3: 1938-01-01 2025-01-01         1986-04-02 1985-01-01 1972-01-01 2002-01-01
# 4: 2004-01-31 3000-01-01         2648-01-23 3000-01-01 2015-12-31 3000-01-01
#}}}
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 1 ................................................
if (i_DataDate > 0) {
  cap <- "Datums - Attribute"
  if (OutputFormat == "pdf") {

    knitr::kable(TableDate_1, caption=cap,
                 row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
                 format="latex", linesep=c(rep("", nrow(TableDate_1)), "\\addlinespace"),
                 escape = FALSE, col.names = linebreak(ColNamesTable_1, align = "c")) %>%
    add_header_above(header = HeaderAboveStr_1) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableDate_1X <- TableDate_1
    colnames(TableDate_1X) <- gsub("\n", " ", colnames(TableDate_1X))
    knitr::kable(TableDate_1X, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
  # rm(TableDate)
  # rm(TableDate_1)
}
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Datum - Attribute"
  SubFigName <- "PlotDate"
  SubName    <- "NPartsDate"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataDate == 0) {"Es sind keine Datum-Attribute vorhanden"}`
```{r PlotDate, child=if(i_DataDate > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

## Wertebereiche der Datum-Attribute
```{r PlotWerteBerDatePrep, echo = FALSE, eval = TRUE, include = TRUE}
# Übersicht als Tabelle ............................................................................
# Tabelle ausgeben .................................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
# Tabelle 2 ................................................
if (i_DataDate > 0) {
  cap <- "Wertebereiche Datums - Attribute"
  if (OutputFormat == "pdf") {

    knitr::kable(TableDate_2, caption=cap,
                 row.names=FALSE, booktabs=TRUE, longtable=FALSE, align="rrr",
                 format="latex", linesep=c(rep("", nrow(TableDate_2)), "\\addlinespace"),
                 escape = FALSE, col.names = linebreak(ColNamesTable_2, align = "c")) %>%
                 add_header_above(header = HeaderAboveStr_2) %>%
    # kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position")) # %>%
    kableExtra::kable_styling(font_size=9, latex_options=c("HOLD_position", "striped")) # %>%
  # kableExtra::kable_styling(font_size=8, latex_options=c("HOLD_position", "striped", "scale_down")) # %>%
  # landscape()

  } else {

    TableDate_2X <- TableDate_2
    colnames(TableDate_2X) <- gsub("\n", " ", colnames(TableDate_2X))
    knitr::kable(TableDate_2X, caption=cap, row.names=FALSE, booktabs=TRUE, align="rrr")

  }
}

# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
# Ausgabe Grafik nur bei zwei Datensätzen ..........................................................
# Grafik - Parameter setzen ........................................................................{{{
# xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx xx
#
  SubFigCap  <- "Wertebereiche Datum - Attribute"
  SubFigName <- "PlotWerteBerDate"
  SubName    <- "NPartsWerteBerDate"
#
# vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
#}}}
```
`r if (i_DataDate == 0) {"Es sind keine Datum-Attribute vorhanden"}`
```{r PlotWerteBerDate, child=if(i_DataDate > 0 & i_ProfileData2) '202_DatenProfilingSubmod.Rmd'}
```

